!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=28)}([function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(t[n]=i[n])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){var e,i,n,r,a,s;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(s=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)a=t[e],s.set(a,r),r+=a.length;return s}},s={arraySet:function(t,e,i,n,r){for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,a)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(n)},function(t,e,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var r=(s=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),a=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(a).concat([r]).join("\n")}var s;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var a=this[r][0];null!=a&&(n[a]=!0)}for(r=0;r<t.length;r++){var s=t[r];null!=s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(t,e,i){var n,r,a={},s=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),o=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),c=null,h=0,l=[],d=i(23);function u(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=a[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(_(n.parts[s],e))}else{var o=[];for(s=0;s<n.parts.length;s++)o.push(_(n.parts[s],e));a[n.id]={id:n.id,refs:1,parts:o}}}}function f(t,e){for(var i=[],n={},r=0;r<t.length;r++){var a=t[r],s=e.base?a[0]+e.base:a[0],o={css:a[1],media:a[2],sourceMap:a[3]};n[s]?n[s].parts.push(o):i.push(n[s]={id:s,parts:[o]})}return i}function p(t,e){var i=o(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),l.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=o(t.insertAt.before,i);i.insertBefore(e,r)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return v(e,t.attrs),p(t,e),e}function v(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function _(t,e){var i,n,r,a;if(e.transform&&t.css){if(!(a="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=a}if(e.singleton){var s=h++;i=c||(c=g(e)),n=y.bind(null,i,s,!1),r=y.bind(null,i,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),p(t,e),e}(e),n=function(t,e,i){var n=i.css,r=i.sourceMap,a=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||a)&&(n=d(n));r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(s),o&&URL.revokeObjectURL(o)}.bind(null,i,e),r=function(){m(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(e),n=function(t,e){var i=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),r=function(){m(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=f(t,e);return u(i,e),function(t){for(var n=[],r=0;r<i.length;r++){var s=i[r];(o=a[s.id]).refs--,n.push(o)}t&&u(f(t,e),e);for(r=0;r<n.length;r++){var o;if(0===(o=n[r]).refs){for(var c=0;c<o.parts.length;c++)o.parts[c]();delete a[o.id]}}}};var b,w=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function y(t,e,i,n){var r=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var a=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}},function(t,e,i){"use strict";t.exports=function(t,e,i,n){for(var r=65535&t|0,a=t>>>16&65535|0,s=0;0!==i;){i-=s=i>2e3?2e3:i;do{a=a+(r=r+e[n++]|0)|0}while(--s);r%=65521,a%=65521}return r|a<<16|0}},function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,e,i,r){var a=n,s=r+i;t^=-1;for(var o=r;o<s;o++)t=t>>>8^a[255&(t^e[o])];return-1^t}},function(t,e,i){"use strict";var n=i(0),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new n.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function c(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",s=0;s<e;s++)i+=String.fromCharCode(t[s]);return i}s[254]=s[254]=1,e.string2buf=function(t){var e,i,r,a,s,o=t.length,c=0;for(a=0;a<o;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),c+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(c),s=0,a=0;s<c;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(r=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},e.buf2binstring=function(t){return c(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,n,r,a,o=e||t.length,h=new Array(2*o);for(n=0,i=0;i<o;)if((r=t[i++])<128)h[n++]=r;else if((a=s[r])>4)h[n++]=65533,i+=a-1;else{for(r&=2===a?31:3===a?15:7;a>1&&i<o;)r=r<<6|63&t[i++],a--;a>1?h[n++]=65533:r<65536?h[n++]=r:(r-=65536,h[n++]=55296|r>>10&1023,h[n++]=56320|1023&r)}return c(h,n)},e.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+s[t[i]]>e?i:e}},function(t,e,i){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,i){var n;!function(i,r,a,s){"use strict";var o,c={URL:i.URL||i.webkitURL||i.mozURL||i.msURL,getUserMedia:(o=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia,o?o.bind(a):o),requestAnimFrame:i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame,requestTimeout:function(t,e){if(t=t||c.noop,e=e||0,!c.requestAnimFrame)return setTimeout(t,e);var i=(new Date).getTime(),n=new Object,r=c.requestAnimFrame;return n.value=r(function a(){(new Date).getTime()-i>=e?t.call():n.value=r(a)}),n},Blob:i.Blob||i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder,btoa:function(){var t=i.btoa||function(t){for(var e="",i=0,n=t.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=void 0,s=void 0,o=void 0,c=void 0,h=void 0,l=void 0,d=void 0;i<n;)c=(a=t.charCodeAt(i++))>>2,h=(3&a)<<4|(s=t.charCodeAt(i++))>>4,l=(15&s)<<2|(o=t.charCodeAt(i++))>>6,d=63&o,isNaN(s)?l=d=64:isNaN(o)&&(d=64),e=e+r.charAt(c)+r.charAt(h)+r.charAt(l)+r.charAt(d);return e};return t?t.bind(i):c.noop}(),isObject:function(t){return t&&"[object Object]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){return c.isObject(t)&&!Object.keys(t).length},isArray:function(t){return t&&Array.isArray(t)},isFunction:function(t){return t&&"function"==typeof t},isElement:function(t){return t&&1===t.nodeType},isString:function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},isSupported:{canvas:function(){var t=r.createElement("canvas");return t&&t.getContext&&t.getContext("2d")},webworkers:function(){return i.Worker},blob:function(){return c.Blob},Uint8Array:function(){return i.Uint8Array},Uint32Array:function(){return i.Uint32Array},videoCodecs:function(){var t=r.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{t&&t.canPlayType&&(e.mp4=""!==t.canPlayType('video/mp4; codecs="mp4v.20.8"'),e.h264=""!==(t.canPlayType('video/mp4; codecs="avc1.42E01E"')||t.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),e.ogv=""!==t.canPlayType('video/ogg; codecs="theora"'),e.ogg=""!==t.canPlayType('video/ogg; codecs="theora"'),e.webm=-1!==t.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(t){}return e}()},noop:function(){},each:function(t,e){var i=void 0,n=void 0;if(c.isArray(t))for(i=-1,n=t.length;++i<n&&!1!==e(i,t[i]););else if(c.isObject(t))for(i in t)if(t.hasOwnProperty(i)&&!1===e(i,t[i]))break},mergeOptions:function(t,e){if(c.isObject(t)&&c.isObject(e)&&Object.keys){var i={};return c.each(t,function(e,n){i[e]=t[e]}),c.each(e,function(n,r){var a=e[n];c.isObject(a)&&t[n]?i[n]=c.mergeOptions(t[n],a):i[n]=a}),i}},setCSSAttr:function(t,e,i){c.isElement(t)&&(c.isString(e)&&c.isString(i)?t.style[e]=i:c.isObject(e)&&c.each(e,function(e,i){t.style[e]=i}))},removeElement:function(t){c.isElement(t)&&t.parentNode&&t.parentNode.removeChild(t)},createWebWorker:function(t){if(!c.isString(t))return{};try{var e=new c.Blob([t],{type:"text/javascript"}),i=c.URL.createObjectURL(e);return{objectUrl:i,worker:new Worker(i)}}catch(t){return""+t}},getExtension:function(t){return t.substr(t.lastIndexOf(".")+1,t.length)},getFontSize:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{};if(!r.body||!1===t.resizeFont)return t.fontSize;var e=t.text,i=t.gifWidth,n=parseInt(t.fontSize,10),a=parseInt(t.minFontSize,10),o=r.createElement("div"),c=r.createElement("span");for(o.setAttribute("width",i),o.appendChild(c),c.innerHTML=e,c.style.fontSize=n+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",r.body.appendChild(c);c.offsetWidth>i&&n>=a;)c.style.fontSize=--n+"px";return r.body.removeChild(c),n+"px"},webWorkerError:!1},h=Object.freeze({default:c}),l={validate:function(t){t=c.isObject(t)?t:{};var e={};return c.each(l.validators,function(i,n){var r=n.errorCode;if(!t[r]&&!n.condition)return(e=n).error=!0,!1}),delete e.condition,e},isValid:function(t){var e=!0!==l.validate(t).error;return e},validators:[{condition:c.isFunction(c.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:c.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:c.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:c.isFunction(c.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:c.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:c.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:c.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},d=Object.freeze({default:l}),u=function(){},f={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:u,completeCallback:u,saveRenderingContexts:!1,savedRenderingContexts:[],showFrameText:!0,crossOrigin:"Anonymous",waterMark:null,waterMarkHeight:null,waterMarkWidth:null,waterMarkXCoordinate:1,waterMarkYCoordinate:1},p=Object.freeze({default:f});function m(){return l.isValid()}function g(){var t,e,i,n,r,a=256,s=499,o=491,c=487,h=503,l=3*h,d=a-1,u=4,f=100,p=16,m=1<<p,g=10,v=10,_=m>>v,b=m<<g-v,w=6,y=(a>>3)*(1<<w),x=30,k=1024,S=256,C=1<<18,z=[],B=[],A=[],E=[];function R(t,e,i,n,s){var o,c,h,l,d,u,f;for((h=e-t)<-1&&(h=-1),(l=e+t)>a&&(l=a),o=e+1,c=e-1,u=1;o<l||c>h;){if(d=E[u++],o<l){f=r[o++];try{f[0]-=d*(f[0]-i)/C|0,f[1]-=d*(f[1]-n)/C|0,f[2]-=d*(f[2]-s)/C|0}catch(t){}}if(c>h){f=r[c--];try{f[0]-=d*(f[0]-i)/C|0,f[1]-=d*(f[1]-n)/C|0,f[2]-=d*(f[2]-s)/C|0}catch(t){}}}}function D(t,e,i,n,a){var s=r[e],o=t/k;s[0]-=o*(s[0]-i)|0,s[1]-=o*(s[1]-n)|0,s[2]-=o*(s[2]-a)|0}function q(t,e,i){var n,s,o,c,h,l,d,f,m,w;for(m=f=~(1<<31),d=l=-1,n=0;n<a;n++)(s=(w=r[n])[0]-t)<0&&(s=-s),(o=w[1]-e)<0&&(o=-o),s+=o,(o=w[2]-i)<0&&(o=-o),(s+=o)<f&&(f=s,l=n),(c=s-(B[n]>>p-u))<m&&(m=c,d=n),h=A[n]>>v,A[n]-=h,B[n]+=h<<g;return A[l]+=_,B[l]-=b,d}(function(t,s,o){var c,h;for(e=t,i=s,n=o,r=new Array(a),c=0;c<a;c++)r[c]=new Array(4),(h=r[c])[0]=h[1]=h[2]=(c<<u+8)/a|0,A[c]=m/a|0,B[c]=0}).apply(this,arguments);var T={map:function(t,e,i){var n,s,o,c,h,l,d;for(h=1e3,d=-1,s=(n=z[e])-1;n<a||s>=0;)n<a&&((o=(l=r[n])[1]-e)>=h?n=a:(n++,o<0&&(o=-o),(c=l[0]-t)<0&&(c=-c),(o+=c)<h&&((c=l[2]-i)<0&&(c=-c),(o+=c)<h&&(h=o,d=l[3])))),s>=0&&((o=e-(l=r[s])[1])>=h?s=-1:(s--,o<0&&(o=-o),(c=l[0]-t)<0&&(c=-c),(o+=c)<h&&((c=l[2]-i)<0&&(c=-c),(o+=c)<h&&(h=o,d=l[3]))));return d}};return T.process=function(){return function(){var r,a,d,p,m,g,v,_,b,C,z,B,A,T;for(i<l&&(n=1),t=30+(n-1)/3,B=e,A=0,T=i,C=(z=i/(3*n))/f|0,_=k,(v=(g=y)>>w)<=1&&(v=0),r=0;r<v;r++)E[r]=_*((v*v-r*r)*S/(v*v));for(b=i<l?3:i%s!=0?3*s:i%o!=0?3*o:i%c!=0?3*c:3*h,r=0;r<z;)if(D(_,a=q(d=(255&B[A+0])<<u,p=(255&B[A+1])<<u,m=(255&B[A+2])<<u),d,p,m),0!==v&&R(v,a,d,p,m),(A+=b)>=T&&(A-=i),0===C&&(C=1),++r%C==0)for(_-=_/t,(v=(g-=g/x)>>w)<=1&&(v=0),a=0;a<v;a++)E[a]=_*((v*v-a*a)*S/(v*v))}(),function(){var t;for(t=0;t<a;t++)r[t][0]>>=u,r[t][1]>>=u,r[t][2]>>=u,r[t][3]=t}(),function(){var t,e,i,n,s,o,c,h;for(c=0,h=0,t=0;t<a;t++){for(i=t,n=(s=r[t])[1],e=t+1;e<a;e++)(o=r[e])[1]<n&&(i=e,n=o[1]);if(o=r[i],t!=i&&(e=o[0],o[0]=s[0],s[0]=e,e=o[1],o[1]=s[1],s[1]=e,e=o[2],o[2]=s[2],s[2]=e,e=o[3],o[3]=s[3],s[3]=e),n!=c){for(z[c]=h+t>>1,e=c+1;e<n;e++)z[e]=t;c=n,h=t}}for(z[c]=h+d>>1,e=c+1;e<256;e++)z[e]=d}(),function(){for(var t=[],e=new Array(a),i=0;i<a;i++)e[r[i][3]]=i;for(var n=0,s=0;s<a;s++){var o=e[s];t[n++]=r[o][0],t[n++]=r[o][1],t[n++]=r[o][2]}return t}()},T}function v(){try{this.onmessage=function(e){var i,n=e.data||{};n.gifshot&&(i=t.run(n),postMessage(i))}}catch(t){}var t={dataToRGB:function(t,e,i){for(var n=e*i*4,r=0,a=[];r<n;)a.push(t[r++]),a.push(t[r++]),a.push(t[r++]),r++;return a},componentizedPaletteToArray:function(t){t=t||[];for(var e=[],i=0;i<t.length;i+=3){var n=t[i],r=t[i+1],a=t[i+2];e.push(n<<16|r<<8|a)}return e},processFrameWithQuantizer:function(t,e,i,n){for(var r=this.dataToRGB(t,e,i),a=new g(r,r.length,n),s=a.process(),o=new Uint32Array(this.componentizedPaletteToArray(s)),c=e*i,h=new Uint8Array(c),l=0,d=0;d<c;d++){var u=r[l++],f=r[l++],p=r[l++];h[d]=a.map(u,f,p)}return{pixels:h,palette:o}},run:function(t){var e=t=t||{},i=e.height,n=(e.palette,e.sampleInterval),r=e.width,a=t.data;return this.processFrameWithQuantizer(a,r,i,n)}};return t}function _(t,e,i,n){var r=0,a=(n=n===s?{}:n).loop===s?null:n.loop,o=n.palette===s?null:n.palette;if(e<=0||i<=0||e>65535||i>65535)throw"Width/Height invalid.";t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;if(t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=0|(null!==o?128:0),t[r++]=0,t[r++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=255&a,t[r++]=a>>8&255,t[r++]=0}var c=!1;this.addFrame=function(e,i,n,a,h,l){if(!0===c&&(--r,c=!1),l=l===s?{}:l,e<0||i<0||e>65535||i>65535)throw"x/y invalid.";if(n<=0||a<=0||n>65535||a>65535)throw"Width/Height invalid.";if(h.length<n*a)throw"Not enough pixels for the frame size.";var d=!0,u=l.palette;if(u!==s&&null!==u||(d=!1,u=o),u===s||null===u)throw"Must supply either a local or global palette.";for(var f=function(t){var e=t.length;if(e<2||e>256||e&e-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return e}(u),p=0;f>>=1;)++p;f=1<<p;var m=l.delay===s?0:l.delay,g=l.disposal===s?0:l.disposal;if(g<0||g>3)throw"Disposal out of range.";var v=!1,_=0;if(l.transparent!==s&&null!==l.transparent&&(v=!0,(_=l.transparent)<0||_>=f))throw"Transparent color index.";if((0!==g||v||0!==m)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=g<<2|(!0===v?1:0),t[r++]=255&m,t[r++]=m>>8&255,t[r++]=_,t[r++]=0),t[r++]=44,t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=255&a,t[r++]=a>>8&255,t[r++]=!0===d?128|p-1:0,!0===d)for(var b=0,w=u.length;b<w;++b){var y=u[b];t[r++]=y>>16&255,t[r++]=y>>8&255,t[r++]=255&y}r=function(t,e,i,n){t[e++]=i;var r=e++,a=1<<i,o=a-1,c=a+1,h=c+1,l=i+1,d=0,u=0;function f(i){for(;d>=i;)t[e++]=255&u,u>>=8,d-=8,e===r+256&&(t[r]=255,r=e++)}function p(t){u|=t<<d,d+=l,f(8)}var m=n[0]&o,g={};p(a);for(var v=1,_=n.length;v<_;++v){var b=n[v]&o,w=m<<8|b,y=g[w];if(y===s){for(u|=m<<d,d+=l;d>=8;)t[e++]=255&u,u>>=8,d-=8,e===r+256&&(t[r]=255,r=e++);4096===h?(p(a),h=c+1,l=i+1,g={}):(h>=1<<l&&++l,g[w]=h++),m=b}else m=y}p(m),p(c),f(1),r+1===e?t[r]=0:(t[r]=e-r-1,t[e++]=0);return e}(t,r,p<2?2:p,h)},this.end=function(){return!1===c&&(t[r++]=59,c=!0),r}}var b=function(){},w=function(t){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=b,this.onRenderProgressCallback=b,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=t,this.initializeWebWorkers(t)};w.prototype={workerMethods:v(),initializeWebWorkers:function(t){var e,i=g.toString()+"("+v.toString()+"());",n=void 0,a=void 0,s=void 0,o=-1,h="";for(e=t.numWorkers;++o<e;)n=c.createWebWorker(i),c.isObject(n)?(a=n.objectUrl,s=n.worker,this.workers.push({worker:s,objectUrl:a}),this.availableWorkers.push(s)):(h=n,c.webWorkerError=!!n);this.workerError=h,this.canvas=r.createElement("canvas"),this.canvas.width=t.gifWidth,this.canvas.height=t.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(t){this.availableWorkers.push(t)},byteMap:function(){for(var t=[],e=0;e<256;e++)t[e]=String.fromCharCode(e);return t}(),bufferToString:function(t){for(var e=t.length,i="",n=-1;++n<e;)i+=this.byteMap[t[n]];return i},onFrameFinished:function(t){var e=this,i=e.frames,n=!!(e.options.images||[]).length,r=i.every(function(t){return!t.beingProcessed&&t.done});e.numRenderedFrames++,n&&t(e.numRenderedFrames/i.length),e.onRenderProgressCallback(.75*e.numRenderedFrames/i.length),r?e.generatingGIF||e.generateGIF(i,e.onRenderCompleteCallback):c.requestTimeout(function(){e.processNextFrame()},1)},processFrame:function(t){var e=this,i=(this.options,this.options),n=i.progressCallback,r=i.sampleInterval,a=this.frames,o=void 0,c=void 0,h=function(){var t=(arguments.length>0&&arguments[0]!==s?arguments[0]:{}).data;delete o.data,o.pixels=Array.prototype.slice.call(t.pixels),o.palette=Array.prototype.slice.call(t.palette),o.done=!0,o.beingProcessed=!1,e.freeWorker(c),e.onFrameFinished(n)};(o=a[t]).beingProcessed||o.done?this.onFrameFinished():(o.sampleInterval=r,o.beingProcessed=!0,o.gifshot=!0,(c=this.getWorker())?(c.onmessage=h,c.postMessage(o)):h({data:e.workerMethods.run(o)}))},startRendering:function(t){this.onRenderCompleteCallback=t;for(var e=0;e<this.options.numWorkers&&e<this.frames.length;e++)this.processFrame(e)},processNextFrame:function(){for(var t=-1,e=0;e<this.frames.length;e++){var i=this.frames[e];if(!i.done&&!i.beingProcessed){t=e;break}}t>=0&&this.processFrame(t)},generateGIF:function(t,e){var i=[],n={loop:this.repeat},r=this.options,a=r.interval,s=r.frameDuration,o=!!r.images.length,h=r.gifHeight,l=r.gifWidth,d=new _(i,l,h,n),u=this.onRenderProgressCallback,f=o?100*a:0,p=void 0;this.generatingGIF=!0,c.each(t,function(e,i){var n=i.palette;u(.75+.25*i.position*1/t.length);for(var r=0;r<s;r++)d.addFrame(0,0,l,h,i.pixels,{palette:n,delay:f})}),d.end(),u(1),this.frames=[],this.generatingGIF=!1,c.isFunction(e)&&(p=this.bufferToString(i),e("data:image/gif;base64,"+c.btoa(p)))},setRepeat:function(t){this.repeat=t},addFrame:function(t,e,i){e=c.isObject(e)?e:{};var n=this.ctx,r=this.options,a=r.gifWidth,s=r.gifHeight,o=c.getFontSize(e),h=e,l=h.filter,d=h.fontColor,u=h.fontFamily,f=h.fontWeight,p=(h.gifHeight,h.gifWidth,h.text),m=h.textAlign,g=h.textBaseline,v=h.waterMark,_=h.waterMarkHeight,b=h.waterMarkWidth,w=h.waterMarkXCoordinate,y=h.waterMarkYCoordinate,x=e.textXCoordinate?e.textXCoordinate:"left"===m?1:"right"===m?a:a/2,k=e.textYCoordinate?e.textYCoordinate:"top"===g?1:"center"===g?s/2:s,S=f+" "+o+" "+u,C=i&&e.showFrameText?i:p,z=void 0;try{n.filter=l,n.drawImage(t,0,0,a,s),C&&(n.font=S,n.fillStyle=d,n.textAlign=m,n.textBaseline=g,n.fillText(C,x,k)),v&&n.drawImage(v,w,y,b,_),z=n.getImageData(0,0,a,s),this.addFrameImageData(z)}catch(t){return""+t}},addFrameImageData:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=this.frames,i=t.data;this.frames.push({data:i,width:t.width,height:t.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:e.length})},onRenderProgress:function(t){this.onRenderProgressCallback=t},isRendering:function(){return this.generatingGIF},getBase64GIF:function(t){var e=this;e.startRendering(function(i){e.destroyWorkers(),c.requestTimeout(function(){t(i)},0)})},destroyWorkers:function(){if(!this.workerError){var t=this.workers;c.each(t,function(t,e){var i=e.worker,n=e.objectUrl;i.terminate(),c.URL.revokeObjectURL(n)})}}};var y=function(){},x={getGIF:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=arguments[1];e=c.isFunction(e)?e:y;var i=r.createElement("canvas"),n=void 0,a=!!t.images.length,o=t.cameraStream,h=t.crop,l=t.filter,d=t.fontColor,u=t.fontFamily,f=t.fontWeight,p=t.keepCameraOn,m=(t.numWorkers,t.progressCallback),g=t.saveRenderingContexts,v=t.savedRenderingContexts,_=t.text,b=t.textAlign,x=t.textBaseline,k=t.videoElement,S=t.videoHeight,C=t.videoWidth,z=t.webcamVideoElement,B=t.waterMark,A=t.waterMarkHeight,E=t.waterMarkWidth,R=t.waterMarkXCoordinate,D=t.waterMarkYCoordinate,q=Number(t.gifWidth),T=Number(t.gifHeight),L=Number(t.interval),I=(Number(t.sampleInterval),a?0:1e3*L),F=[],P=v.length?v.length:t.numFrames,U=P,M=new w(t),W=c.getFontSize(t),O=t.textXCoordinate?t.textXCoordinate:"left"===b?1:"right"===b?q:q/2,N=t.textYCoordinate?t.textYCoordinate:"top"===x?1:"center"===x?T/2:T,H=f+" "+W+" "+u,j=h?Math.floor(h.scaledWidth/2):0,G=h?C-h.scaledWidth:0,Z=h?Math.floor(h.scaledHeight/2):0,V=h?S-h.scaledHeight:0;P=P!==s?P:10,L=L!==s?L:.1,i.width=q,i.height=T,n=i.getContext("2d"),function t(){v.length||0!==k.currentTime?function t(){var i=U-1;function r(){var r;g&&F.push(n.getImageData(0,0,q,T)),B&&n.drawImage(B,R,D,E,A),_&&(n.font=H,n.fillStyle=d,n.textAlign=b,n.textBaseline=x,n.fillText(_,O,N)),r=n.getImageData(0,0,q,T),M.addFrameImageData(r),m((P-(U=i))/P),i>0&&c.requestTimeout(t,I),U||M.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t,cameraStream:o,videoElement:k,webcamVideoElement:z,savedRenderingContexts:F,keepCameraOn:p})})}v.length?(n.putImageData(v[P-U],0,0),r()):function t(){try{G>C&&(G=C),V>S&&(V=S),j<0&&(j=0),Z<0&&(Z=0),n.filter=l,n.drawImage(k,j,Z,G,V,0,0,q,T),r()}catch(e){if("NS_ERROR_NOT_AVAILABLE"!==e.name)throw e;c.requestTimeout(t,100)}}()}():c.requestTimeout(t,100)}()},getCropDimensions:function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.videoWidth,i=t.videoHeight,n=t.gifWidth,r=t.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return e>i?(a.width=Math.round(e*(r/i))-n,a.scaledWidth=Math.round(a.width*(i/r))):(a.height=Math.round(i*(n/e))-r,a.scaledHeight=Math.round(a.height*(e/n))),a}},k={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function t(e){t.attempts=t.attempts||0;var i=e.cameraStream,n=e.completedCallback,r=e.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",k.findVideoSize),n({videoElement:r,cameraStream:i,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):t.attempts<10?(t.attempts+=1,c.requestTimeout(function(){k.findVideoSize(e)},400)):n({videoElement:r,cameraStream:i,videoWidth:k.defaultVideoDimensions.width,videoHeight:k.defaultVideoDimensions.height}))},onStreamingTimeout:function(t){c.isFunction(t)&&t({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(t){var e=c.isArray(t.existingVideo)?t.existingVideo[0]:t.existingVideo,i=t.cameraStream,n=t.completedCallback,r=t.streamedCallback,a=t.videoElement;if(c.isFunction(r)&&r(),e){if(c.isString(e))a.src=e,a.innerHTML='<source src="'+e+'" type="video/'+c.getExtension(e)+'" />';else if(e instanceof Blob){try{a.src=c.URL.createObjectURL(e)}catch(t){}a.innerHTML='<source src="'+e+'" type="'+e.type+'" />'}}else if(a.mozSrcObject)a.mozSrcObject=i;else if(c.URL)try{a.srcObject=i,a.src=c.URL.createObjectURL(i)}catch(t){a.srcObject=i}a.play(),c.requestTimeout(function t(){t.count=t.count||0,!0===k.loadedData?(k.findVideoSize({videoElement:a,cameraStream:i,completedCallback:n}),k.loadedData=!1):(t.count+=1)>10?k.findVideoSize({videoElement:a,cameraStream:i,completedCallback:n}):t()},0)},startStreaming:function(t){var e=c.isFunction(t.error)?t.error:c.noop,i=c.isFunction(t.streamed)?t.streamed:c.noop,n=c.isFunction(t.completed)?t.completed:c.noop,a=t.crossOrigin,s=t.existingVideo,o=t.lastCameraStream,h=t.options,l=t.webcamVideoElement,d=c.isElement(s)?s:l||r.createElement("video");a&&(d.crossOrigin=h.crossOrigin),d.autoplay=!0,d.loop=!0,d.muted=!0,d.addEventListener("loadeddata",function(t){k.loadedData=!0,h.offset&&(d.currentTime=h.offset)}),s?k.stream({videoElement:d,existingVideo:s,completedCallback:n}):o?k.stream({videoElement:d,cameraStream:o,streamedCallback:i,completedCallback:n}):c.getUserMedia({video:!0},function(t){k.stream({videoElement:d,cameraStream:t,streamedCallback:i,completedCallback:n})},e)},startVideoStreaming:function(t){var e=arguments.length>1&&arguments[1]!==s?arguments[1]:{},i=e.timeout!==s?e.timeout:0,n=e.callback,r=e.webcamVideoElement,a=void 0;i>0&&(a=c.requestTimeout(function(){k.onStreamingTimeout(n)},1e4)),k.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var e=arguments.length>0&&arguments[0]!==s?arguments[0]:{},i=e.cameraStream,n=e.videoElement,r=e.videoHeight,a=e.videoWidth;t({cameraStream:i,videoElement:n,videoHeight:r,videoWidth:a})},lastCameraStream:e.lastCameraStream,webcamVideoElement:r,crossOrigin:e.crossOrigin,options:e})},stopVideoStreaming:function(t){var e=t=c.isObject(t)?t:{},i=e.keepCameraOn,n=e.videoElement,r=e.webcamVideoElement,a=t.cameraStream||{},s=a.getTracks&&a.getTracks()||[],o=!!s.length,h=s[0];!i&&o&&c.isFunction(h.stop)&&h.stop(),c.isElement(n)&&!r&&(n.pause(),c.isFunction(c.URL.revokeObjectURL)&&!c.webWorkerError&&n.src&&c.URL.revokeObjectURL(n.src),c.removeElement(n))}};function S(t){t=c.isObject(t)?t:{},k.stopVideoStreaming(t)}function C(t,e){var i=t.options||{},n=i.images,a=i.video,s=Number(i.gifWidth),o=Number(i.gifHeight),h=(Number(i.numFrames),t.cameraStream),l=t.videoElement,d=t.videoWidth,u=t.videoHeight,f=x.getCropDimensions({videoWidth:d,videoHeight:u,gifHeight:o,gifWidth:s}),p=e;i.crop=f,i.videoElement=l,i.videoWidth=d,i.videoHeight=u,i.cameraStream=h,c.isElement(l)&&(l.width=s+f.width,l.height=o+f.height,i.webcamVideoElement||(c.setCSSAttr(l,{position:"fixed",opacity:"0"}),r.body.appendChild(l)),l.play(),x.getGIF(i,function(t){n&&n.length||a&&a.length||S(t),p(t)}))}function z(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var i=c.mergeOptions(f,t)||{},n=t.cameraStream,a=i.images,o=a?a.length:0,h=i.video,d=i.webcamVideoElement;i=c.mergeOptions(i,{gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),o?function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,i=t.images,n=t.options,a=t.imagesLength,o=l.validate({getUserMedia:!0,"window.URL":!0}),h=[],d=0,u=void 0,f=void 0;if(o.error)return e(o);function p(){c.each(h,function(t,e){e&&(e.text?f.addFrame(e.img,n,e.text):f.addFrame(e,n))}),function(t,e){t.getBase64GIF(function(t){e({error:!1,errorCode:"",errorMsg:"",image:t})})}(f,e)}f=new w(n),c.each(i,function(t,i){var s=i;i.src&&(s=s.src),c.isElement(s)?(n.crossOrigin&&(s.crossOrigin=n.crossOrigin),h[t]=s,(d+=1)===a&&p()):c.isString(s)&&(u=new Image,n.crossOrigin&&(u.crossOrigin=n.crossOrigin),function(n){i.text&&(n.text=i.text),n.onerror=function(t){var i=void 0;if(0==--a)return(i={}).error="None of the requested images was capable of being retrieved",e(i)},n.onload=function(e){i.text?h[t]={img:n,text:n.text}:h[t]=n,(d+=1)===a&&p(),c.removeElement(n)},n.src=s}(u),c.setCSSAttr(u,{position:"fixed",opacity:"0"}),r.body.appendChild(u))})}({images:a,imagesLength:o,callback:e,options:i}):h?function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,i=t.existingVideo,n=t.options,r=l.validate({getUserMedia:!0,"window.URL":!0}),a=void 0,o=void 0;if(r.error)return e(r);if(c.isElement(i)&&i.src){if(o=i.src,a=c.getExtension(o),!c.isSupported.videoCodecs[a])return e(l.messages.videoCodecs)}else c.isArray(i)&&c.each(i,function(t,e){if(a=e instanceof Blob?e.type.substr(e.type.lastIndexOf("/")+1,e.length):e.substr(e.lastIndexOf(".")+1,e.length),c.isSupported.videoCodecs[a])return i=e,!1});k.startStreaming({completed:function(t){t.options=n||{},C(t,e)},existingVideo:i,crossOrigin:n.crossOrigin,options:n})}({existingVideo:h,callback:e,options:i}):function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{},e=t.callback,i=t.lastCameraStream,n=t.options,r=t.webcamVideoElement;if(!m())return e(l.validate());n.savedRenderingContexts.length?x.getGIF(n,function(t){e(t)}):k.startVideoStreaming(function(){var t=arguments.length>0&&arguments[0]!==s?arguments[0]:{};t.options=n||{},C(t,e)},{lastCameraStream:i,callback:e,webcamVideoElement:r,crossOrigin:n.crossOrigin})}({lastCameraStream:n,callback:e,webcamVideoElement:d,options:i})}}var B={utils:h,error:d,defaultOptions:p,createGIF:z,takeSnapShot:function(t,e){if(e=c.isFunction(t)?t:e,t=c.isObject(t)?t:{},c.isFunction(e)){var i=c.mergeOptions(f,t);z(c.mergeOptions(i,{interval:.1,numFrames:1,gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),e)}},stopVideoStreaming:S,isSupported:function(){return l.isValid()},isWebCamGIFSupported:m,isExistingVideoGIFSupported:function(t){var e=!1;if(c.isArray(t)&&t.length){if(c.each(t,function(t,i){c.isSupported.videoCodecs[i]&&(e=!0)}),!e)return!1}else if(c.isString(t)&&t.length&&!c.isSupported.videoCodecs[t])return!1;return l.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return l.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(n=function(){return B}.apply(e,[]))===s||(t.exports=n)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},function(t,e,i){(function(e){!function(){var e={};t.exports=e,function(t,e){t.toRGBA8=function(e){var i=e.width,n=e.height;if(null==e.tabs.acTL)return[t.toRGBA8.decodeImage(e.data,i,n,e).buffer];var r=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var a,s=new Uint8Array(i*n*4),o=0;o<e.frames.length;o++){var c=e.frames[o],h=c.rect.x,l=c.rect.y,d=c.rect.width,u=c.rect.height,f=t.toRGBA8.decodeImage(c.data,d,u,e);if(0==o?a=f:0==c.blend?t._copyTile(f,d,u,a,i,n,h,l,0):1==c.blend&&t._copyTile(f,d,u,a,i,n,h,l,1),r.push(a.buffer),a=a.slice(0),0==c.dispose);else if(1==c.dispose)t._copyTile(s,d,u,a,i,n,h,l,0);else if(2==c.dispose){for(var p=o-1;2==e.frames[p].dispose;)p--;a=new Uint8Array(r[p]).slice(0)}}return r},t.toRGBA8.decodeImage=function(e,i,n,r){var a=i*n,s=t.decode._getBPP(r),o=Math.ceil(i*s/8),c=new Uint8Array(4*a),h=new Uint32Array(c.buffer),l=r.ctype,d=r.depth,u=t._bin.readUshort;if(6==l){var f=a<<2;if(8==d)for(var p=0;p<f;p++)c[p]=e[p];if(16==d)for(p=0;p<f;p++)c[p]=e[p<<1]}else if(2==l){var m=r.tabs.tRNS,g=-1,v=-1,_=-1;if(m&&(g=m[0],v=m[1],_=m[2]),8==d)for(p=0;p<a;p++){var b=3*p;c[z=p<<2]=e[b],c[z+1]=e[b+1],c[z+2]=e[b+2],c[z+3]=255,-1!=g&&e[b]==g&&e[b+1]==v&&e[b+2]==_&&(c[z+3]=0)}if(16==d)for(p=0;p<a;p++){b=6*p;c[z=p<<2]=e[b],c[z+1]=e[b+2],c[z+2]=e[b+4],c[z+3]=255,-1!=g&&u(e,b)==g&&u(e,b+2)==v&&u(e,b+4)==_&&(c[z+3]=0)}}else if(3==l){var w=r.tabs.PLTE,y=r.tabs.tRNS,x=y?y.length:0;if(1==d)for(var k=0;k<n;k++){var S=k*o,C=k*i;for(p=0;p<i;p++){var z=C+p<<2,B=3*(A=e[S+(p>>3)]>>7-((7&p)<<0)&1);c[z]=w[B],c[z+1]=w[B+1],c[z+2]=w[B+2],c[z+3]=A<x?y[A]:255}}if(2==d)for(k=0;k<n;k++)for(S=k*o,C=k*i,p=0;p<i;p++){z=C+p<<2,B=3*(A=e[S+(p>>2)]>>6-((3&p)<<1)&3);c[z]=w[B],c[z+1]=w[B+1],c[z+2]=w[B+2],c[z+3]=A<x?y[A]:255}if(4==d)for(k=0;k<n;k++)for(S=k*o,C=k*i,p=0;p<i;p++){z=C+p<<2,B=3*(A=e[S+(p>>1)]>>4-((1&p)<<2)&15);c[z]=w[B],c[z+1]=w[B+1],c[z+2]=w[B+2],c[z+3]=A<x?y[A]:255}if(8==d)for(p=0;p<a;p++){var A;z=p<<2,B=3*(A=e[p]);c[z]=w[B],c[z+1]=w[B+1],c[z+2]=w[B+2],c[z+3]=A<x?y[A]:255}}else if(4==l){if(8==d)for(p=0;p<a;p++){z=p<<2;var E=e[R=p<<1];c[z]=E,c[z+1]=E,c[z+2]=E,c[z+3]=e[R+1]}if(16==d)for(p=0;p<a;p++){var R;z=p<<2,E=e[R=p<<2];c[z]=E,c[z+1]=E,c[z+2]=E,c[z+3]=e[R+2]}}else if(0==l){g=r.tabs.tRNS?r.tabs.tRNS:-1;if(1==d)for(p=0;p<a;p++){var D=(E=255*(e[p>>3]>>7-(7&p)&1))==255*g?0:255;h[p]=D<<24|E<<16|E<<8|E}if(2==d)for(p=0;p<a;p++){D=(E=85*(e[p>>2]>>6-((3&p)<<1)&3))==85*g?0:255;h[p]=D<<24|E<<16|E<<8|E}if(4==d)for(p=0;p<a;p++){D=(E=17*(e[p>>1]>>4-((1&p)<<2)&15))==17*g?0:255;h[p]=D<<24|E<<16|E<<8|E}if(8==d)for(p=0;p<a;p++){D=(E=e[p])==g?0:255;h[p]=D<<24|E<<16|E<<8|E}if(16==d)for(p=0;p<a;p++){E=e[p<<1],D=u(e,p<<1)==g?0:255;h[p]=D<<24|E<<16|E<<8|E}}return c},t.decode=function(e){for(var i,n=new Uint8Array(e),r=8,a=t._bin,s=a.readUshort,o=a.readUint,c={tabs:{},frames:[]},h=new Uint8Array(n.length),l=0,d=0,u=[137,80,78,71,13,10,26,10],f=0;f<8;f++)if(n[f]!=u[f])throw"The input is not a PNG file!";for(;r<n.length;){var p=a.readUint(n,r);r+=4;var m=a.readASCII(n,r,4);if(r+=4,"IHDR"==m)t.decode._IHDR(n,r,c);else if("IDAT"==m){for(f=0;f<p;f++)h[l+f]=n[r+f];l+=p}else if("acTL"==m)c.tabs[m]={num_frames:o(n,r),num_plays:o(n,r+4)},i=new Uint8Array(n.length);else if("fcTL"==m){var g;if(0!=d)(g=c.frames[c.frames.length-1]).data=t.decode._decompress(c,i.slice(0,d),g.rect.width,g.rect.height),d=0;var v={x:o(n,r+12),y:o(n,r+16),width:o(n,r+4),height:o(n,r+8)},_=s(n,r+22);_=s(n,r+20)/(0==_?100:_);var b={rect:v,delay:Math.round(1e3*_),dispose:n[r+24],blend:n[r+25]};c.frames.push(b)}else if("fdAT"==m){for(f=0;f<p-4;f++)i[d+f]=n[r+f+4];d+=p-4}else if("pHYs"==m)c.tabs[m]=[a.readUint(n,r),a.readUint(n,r+4),n[r+8]];else if("cHRM"==m){c.tabs[m]=[];for(f=0;f<8;f++)c.tabs[m].push(a.readUint(n,r+4*f))}else if("tEXt"==m){null==c.tabs[m]&&(c.tabs[m]={});var w=a.nextZero(n,r),y=a.readASCII(n,r,w-r),x=a.readASCII(n,w+1,r+p-w-1);c.tabs[m][y]=x}else if("iTXt"==m){null==c.tabs[m]&&(c.tabs[m]={});w=0;var k=r;w=a.nextZero(n,k);y=a.readASCII(n,k,w-k),n[k=w+1],n[k+1];k+=2,w=a.nextZero(n,k);a.readASCII(n,k,w-k);k=w+1,w=a.nextZero(n,k);a.readUTF8(n,k,w-k);k=w+1;x=a.readUTF8(n,k,p-(k-r));c.tabs[m][y]=x}else if("PLTE"==m)c.tabs[m]=a.readBytes(n,r,p);else if("hIST"==m){var S=c.tabs.PLTE.length/3;c.tabs[m]=[];for(f=0;f<S;f++)c.tabs[m].push(s(n,r+2*f))}else if("tRNS"==m)3==c.ctype?c.tabs[m]=a.readBytes(n,r,p):0==c.ctype?c.tabs[m]=s(n,r):2==c.ctype&&(c.tabs[m]=[s(n,r),s(n,r+2),s(n,r+4)]);else if("gAMA"==m)c.tabs[m]=a.readUint(n,r)/1e5;else if("sRGB"==m)c.tabs[m]=n[r];else if("bKGD"==m)0==c.ctype||4==c.ctype?c.tabs[m]=[s(n,r)]:2==c.ctype||6==c.ctype?c.tabs[m]=[s(n,r),s(n,r+2),s(n,r+4)]:3==c.ctype&&(c.tabs[m]=n[r]);else if("IEND"==m)break;r+=p;a.readUint(n,r);r+=4}0!=d&&((g=c.frames[c.frames.length-1]).data=t.decode._decompress(c,i.slice(0,d),g.rect.width,g.rect.height),d=0);return c.data=t.decode._decompress(c,h,c.width,c.height),delete c.compress,delete c.interlace,delete c.filter,c},t.decode._decompress=function(e,i,n,r){return 0==e.compress&&(i=t.decode._inflate(i)),0==e.interlace?i=t.decode._filterZero(i,e,0,n,r):1==e.interlace&&(i=t.decode._readInterlace(i,e)),i},t.decode._inflate=function(t){return e.inflate(t)},t.decode._readInterlace=function(e,i){for(var n=i.width,r=i.height,a=t.decode._getBPP(i),s=a>>3,o=Math.ceil(n*a/8),c=new Uint8Array(r*o),h=0,l=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],f=[8,8,4,4,2,2,1],p=0;p<7;){for(var m=u[p],g=f[p],v=0,_=0,b=l[p];b<r;)b+=m,_++;for(var w=d[p];w<n;)w+=g,v++;var y=Math.ceil(v*a/8);t.decode._filterZero(e,i,h,v,_);for(var x=0,k=l[p];k<r;){for(var S=d[p],C=h+x*y<<3;S<n;){var z;if(1==a)z=(z=e[C>>3])>>7-(7&C)&1,c[k*o+(S>>3)]|=z<<7-((3&S)<<0);if(2==a)z=(z=e[C>>3])>>6-(7&C)&3,c[k*o+(S>>2)]|=z<<6-((3&S)<<1);if(4==a)z=(z=e[C>>3])>>4-(7&C)&15,c[k*o+(S>>1)]|=z<<4-((1&S)<<2);if(a>=8)for(var B=k*o+S*s,A=0;A<s;A++)c[B+A]=e[(C>>3)+A];C+=a,S+=g}x++,k+=m}v*_!=0&&(h+=_*(1+y)),p+=1}return c},t.decode._getBPP=function(t){return[1,null,3,1,2,null,4][t.ctype]*t.depth},t.decode._filterZero=function(e,i,n,r,a){var s=t.decode._getBPP(i),o=Math.ceil(r*s/8),c=t.decode._paeth;s=Math.ceil(s/8);for(var h=0;h<a;h++){var l=n+h*o,d=l+h+1,u=e[d-1];if(0==u)for(var f=0;f<o;f++)e[l+f]=e[d+f];else if(1==u){for(f=0;f<s;f++)e[l+f]=e[d+f];for(f=s;f<o;f++)e[l+f]=e[d+f]+e[l+f-s]&255}else if(0==h){for(f=0;f<s;f++)e[l+f]=e[d+f];if(2==u)for(f=s;f<o;f++)e[l+f]=255&e[d+f];if(3==u)for(f=s;f<o;f++)e[l+f]=e[d+f]+(e[l+f-s]>>1)&255;if(4==u)for(f=s;f<o;f++)e[l+f]=e[d+f]+c(e[l+f-s],0,0)&255}else{if(2==u)for(f=0;f<o;f++)e[l+f]=e[d+f]+e[l+f-o]&255;if(3==u){for(f=0;f<s;f++)e[l+f]=e[d+f]+(e[l+f-o]>>1)&255;for(f=s;f<o;f++)e[l+f]=e[d+f]+(e[l+f-o]+e[l+f-s]>>1)&255}if(4==u){for(f=0;f<s;f++)e[l+f]=e[d+f]+c(0,e[l+f-o],0)&255;for(f=s;f<o;f++)e[l+f]=e[d+f]+c(e[l+f-s],e[l+f-o],e[l+f-s-o])&255}}}return e},t.decode._paeth=function(t,e,i){var n=t+e-i,r=Math.abs(n-t),a=Math.abs(n-e),s=Math.abs(n-i);return r<=a&&r<=s?t:a<=s?e:i},t.decode._IHDR=function(e,i,n){var r=t._bin;n.width=r.readUint(e,i),i+=4,n.height=r.readUint(e,i),i+=4,n.depth=e[i],i++,n.ctype=e[i],i++,n.compress=e[i],i++,n.filter=e[i],i++,n.interlace=e[i],i++},t._bin={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},writeUshort:function(t,e,i){t[e]=i>>8&255,t[e+1]=255&i},readUint:function(t,e){return 16777216*t[e]+(t[e+1]<<16|t[e+2]<<8|t[e+3])},writeUint:function(t,e,i){t[e]=i>>24&255,t[e+1]=i>>16&255,t[e+2]=i>>8&255,t[e+3]=255&i},readASCII:function(t,e,i){for(var n="",r=0;r<i;r++)n+=String.fromCharCode(t[e+r]);return n},writeASCII:function(t,e,i){for(var n=0;n<i.length;n++)t[e+n]=i.charCodeAt(n)},readBytes:function(t,e,i){for(var n=[],r=0;r<i;r++)n.push(t[e+r]);return n},pad:function(t){return t.length<2?"0"+t:t},readUTF8:function(e,i,n){for(var r,a="",s=0;s<n;s++)a+="%"+t._bin.pad(e[i+s].toString(16));try{r=decodeURIComponent(a)}catch(r){return t._bin.readASCII(e,i,n)}return r}},t._copyTile=function(t,e,i,n,r,a,s,o,c){for(var h=Math.min(e,r),l=Math.min(i,a),d=0,u=0,f=0;f<l;f++)for(var p=0;p<h;p++)if(s>=0&&o>=0?(d=f*e+p<<2,u=(o+f)*r+s+p<<2):(d=(-o+f)*e-s+p<<2,u=f*r+p<<2),0==c)n[u]=t[d],n[u+1]=t[d+1],n[u+2]=t[d+2],n[u+3]=t[d+3];else if(1==c){var m=t[d+3]*(1/255),g=t[d]*m,v=t[d+1]*m,_=t[d+2]*m,b=n[u+3]*(1/255),w=n[u]*b,y=n[u+1]*b,x=n[u+2]*b,k=1-m,S=m+b*k,C=0==S?0:1/S;n[u+3]=255*S,n[u+0]=(g+w*k)*C,n[u+1]=(v+y*k)*C,n[u+2]=(_+x*k)*C}else if(2==c){m=t[d+3],g=t[d],v=t[d+1],_=t[d+2],b=n[u+3],w=n[u],y=n[u+1],x=n[u+2];m==b&&g==w&&v==y&&_==x?(n[u]=0,n[u+1]=0,n[u+2]=0,n[u+3]=0):(n[u]=g,n[u+1]=v,n[u+2]=_,n[u+3]=m)}else if(3==c){m=t[d+3],g=t[d],v=t[d+1],_=t[d+2],b=n[u+3],w=n[u],y=n[u+1],x=n[u+2];if(m==b&&g==w&&v==y&&_==x)continue;if(m<220&&b>20)return!1}return!0},t.encode=function(e,i,n,r,a,s){null==r&&(r=0),null==s&&(s=!1);var o=t.encode.compress(e,i,n,r,!1,s);return t.encode.compressPNG(o,-1),t.encode._main(o,i,n,a)},t.encodeLL=function(e,i,n,r,a,s,o){for(var c={ctype:0+(1==r?0:2)+(0==a?0:4),depth:s,frames:[]},h=(r+a)*s,l=h*i,d=0;d<e.length;d++)c.frames.push({rect:{x:0,y:0,width:i,height:n},img:new Uint8Array(e[d]),blend:0,dispose:1,bpp:Math.ceil(h/8),bpl:Math.ceil(l/8)});return t.encode.compressPNG(c,4),t.encode._main(c,i,n,o)},t.encode._main=function(e,i,n,r){var a=t.crc.crc,s=t._bin.writeUint,o=t._bin.writeUshort,c=t._bin.writeASCII,h=8,l=e.frames.length>1,d=!1,u=46+(l?20:0);if(3==e.ctype){for(var f=e.plte.length,p=0;p<f;p++)e.plte[p]>>>24!=255&&(d=!0);u+=8+3*f+4+(d?8+1*f+4:0)}for(var m=0;m<e.frames.length;m++){l&&(u+=38),u+=(S=e.frames[m]).cimg.length+12,0!=m&&(u+=4)}u+=12;var g=new Uint8Array(u),v=[137,80,78,71,13,10,26,10];for(p=0;p<8;p++)g[p]=v[p];if(s(g,h,13),c(g,h+=4,"IHDR"),s(g,h+=4,i),s(g,h+=4,n),g[h+=4]=e.depth,g[++h]=e.ctype,g[++h]=0,g[++h]=0,g[++h]=0,s(g,++h,a(g,h-17,17)),s(g,h+=4,1),c(g,h+=4,"sRGB"),g[h+=4]=1,s(g,++h,a(g,h-5,5)),h+=4,l&&(s(g,h,8),c(g,h+=4,"acTL"),s(g,h+=4,e.frames.length),s(g,h+=4,0),s(g,h+=4,a(g,h-12,12)),h+=4),3==e.ctype){s(g,h,3*(f=e.plte.length)),c(g,h+=4,"PLTE"),h+=4;for(p=0;p<f;p++){var _=3*p,b=e.plte[p],w=255&b,y=b>>>8&255,x=b>>>16&255;g[h+_+0]=w,g[h+_+1]=y,g[h+_+2]=x}if(s(g,h+=3*f,a(g,h-3*f-4,3*f+4)),h+=4,d){s(g,h,f),c(g,h+=4,"tRNS"),h+=4;for(p=0;p<f;p++)g[h+p]=e.plte[p]>>>24&255;s(g,h+=f,a(g,h-f-4,f+4)),h+=4}}var k=0;for(m=0;m<e.frames.length;m++){var S=e.frames[m];l&&(s(g,h,26),c(g,h+=4,"fcTL"),s(g,h+=4,k++),s(g,h+=4,S.rect.width),s(g,h+=4,S.rect.height),s(g,h+=4,S.rect.x),s(g,h+=4,S.rect.y),o(g,h+=4,r[m]),o(g,h+=2,1e3),g[h+=2]=S.dispose,g[++h]=S.blend,s(g,++h,a(g,h-30,30)),h+=4);var C=S.cimg;s(g,h,(f=C.length)+(0==m?0:4));var z=h+=4;c(g,h,0==m?"IDAT":"fdAT"),h+=4,0!=m&&(s(g,h,k++),h+=4);for(p=0;p<f;p++)g[h+p]=C[p];s(g,h+=f,a(g,z,h-z)),h+=4}return s(g,h,0),c(g,h+=4,"IEND"),s(g,h+=4,a(g,h-4,4)),h+=4,g.buffer},t.encode.compressPNG=function(e,i){for(var n=0;n<e.frames.length;n++){var r=e.frames[n],a=(r.rect.width,r.rect.height),s=new Uint8Array(a*r.bpl+a);r.cimg=t.encode._filterZero(r.img,a,r.bpp,r.bpl,s,i)}},t.encode.compress=function(e,i,n,r,a,s){null==s&&(s=!1);for(var o=6,c=8,h=255,l=0;l<e.length;l++)for(var d=new Uint8Array(e[l]),u=d.length,f=0;f<u;f+=4)h&=d[f+3];var p=255!=h,m=p&&a,g=t.encode.framize(e,i,n,a,m),v={},_=[],b=[];if(0!=r){var w=[];for(f=0;f<g.length;f++)w.push(g[f].img.buffer);var y=t.encode.concatRGBA(w,a),x=t.quantize(y,r),k=0,S=new Uint8Array(x.abuf);for(f=0;f<g.length;f++){var C=(H=g[f].img).length;b.push(new Uint8Array(x.inds.buffer,k>>2,C>>2));for(l=0;l<C;l+=4)H[l]=S[k+l],H[l+1]=S[k+l+1],H[l+2]=S[k+l+2],H[l+3]=S[k+l+3];k+=C}for(f=0;f<x.plte.length;f++)_.push(x.plte[f].est.rgba)}else for(l=0;l<g.length;l++){var z=g[l],B=new Uint32Array(z.img.buffer),A=z.rect.width,E=(u=B.length,new Uint8Array(u));b.push(E);for(f=0;f<u;f++){var R=B[f];if(0!=f&&R==B[f-1])E[f]=E[f-1];else if(f>A&&R==B[f-A])E[f]=E[f-A];else{var D=v[R];if(null==D&&(v[R]=D=_.length,_.push(R),_.length>=300))break;E[f]=D}}}var q=_.length;q<=256&&0==s&&(c=q<=2?1:q<=4?2:q<=16?4:8,a&&(c=8));for(l=0;l<g.length;l++){(z=g[l]).rect.x,z.rect.y,A=z.rect.width;var T=z.rect.height,L=z.img,I=(new Uint32Array(L.buffer),4*A),F=4;if(q<=256&&0==s){I=Math.ceil(c*A/8);for(var P=new Uint8Array(I*T),U=b[l],M=0;M<T;M++){f=M*I;var W=M*A;if(8==c)for(var O=0;O<A;O++)P[f+O]=U[W+O];else if(4==c)for(O=0;O<A;O++)P[f+(O>>1)]|=U[W+O]<<4-4*(1&O);else if(2==c)for(O=0;O<A;O++)P[f+(O>>2)]|=U[W+O]<<6-2*(3&O);else if(1==c)for(O=0;O<A;O++)P[f+(O>>3)]|=U[W+O]<<7-1*(7&O)}L=P,o=3,F=1}else if(0==p&&1==g.length){P=new Uint8Array(A*T*3);var N=A*T;for(f=0;f<N;f++){var H,j=4*f;P[H=3*f]=L[j],P[H+1]=L[j+1],P[H+2]=L[j+2]}L=P,o=2,F=3,I=3*A}z.img=L,z.bpl=I,z.bpp=F}return{ctype:o,depth:c,plte:_,frames:g}},t.encode.framize=function(e,i,n,r,a){for(var s=[],o=0;o<e.length;o++){var c=new Uint8Array(e[o]),h=new Uint32Array(c.buffer),l=0,d=0,u=i,f=n,p=0;if(0==o||a)c=c.slice(0);else{for(var m=r||1==o||2==s[s.length-2].dispose?1:2,g=0,v=1e9,_=0;_<m;_++){for(var b=new Uint8Array(e[o-1-_]),w=new Uint32Array(e[o-1-_]),y=i,x=n,k=-1,S=-1,C=0;C<n;C++)for(var z=0;z<i;z++){var B=C*i+z;h[B]!=w[B]&&(z<y&&(y=z),z>k&&(k=z),C<x&&(x=C),C>S&&(S=C))}var A=-1==k?1:(k-y+1)*(S-x+1);A<v&&(v=A,g=_,-1==k?(l=d=0,u=f=1):(l=y,d=x,u=k-y+1,f=S-x+1))}b=new Uint8Array(e[o-1-g]);1==g&&(s[s.length-1].dispose=2);var E=new Uint8Array(u*f*4);new Uint32Array(E.buffer);t._copyTile(b,i,n,E,u,f,-l,-d,0),t._copyTile(c,i,n,E,u,f,-l,-d,3)?(t._copyTile(c,i,n,E,u,f,-l,-d,2),p=1):(t._copyTile(c,i,n,E,u,f,-l,-d,0),p=0),c=E}s.push({rect:{x:l,y:d,width:u,height:f},img:c,blend:p,dispose:a?1:0})}return s},t.encode._filterZero=function(i,n,r,a,s,o){if(-1!=o){for(var c=0;c<n;c++)t.encode._filterLine(s,i,c,a,r,o);return e.deflate(s)}for(var h=[],l=0;l<5;l++)if(!(n*a>5e5)||2!=l&&3!=l&&4!=l){for(c=0;c<n;c++)t.encode._filterLine(s,i,c,a,r,l);if(h.push(e.deflate(s)),1==r)break}for(var d,u=1e9,f=0;f<h.length;f++)h[f].length<u&&(d=f,u=h[f].length);return h[d]},t.encode._filterLine=function(e,i,n,r,a,s){var o=n*r,c=o+n,h=t.decode._paeth;if(e[c]=s,c++,0==s)for(var l=0;l<r;l++)e[c+l]=i[o+l];else if(1==s){for(l=0;l<a;l++)e[c+l]=i[o+l];for(l=a;l<r;l++)e[c+l]=i[o+l]-i[o+l-a]+256&255}else if(0==n){for(l=0;l<a;l++)e[c+l]=i[o+l];if(2==s)for(l=a;l<r;l++)e[c+l]=i[o+l];if(3==s)for(l=a;l<r;l++)e[c+l]=i[o+l]-(i[o+l-a]>>1)+256&255;if(4==s)for(l=a;l<r;l++)e[c+l]=i[o+l]-h(i[o+l-a],0,0)+256&255}else{if(2==s)for(l=0;l<r;l++)e[c+l]=i[o+l]+256-i[o+l-r]&255;if(3==s){for(l=0;l<a;l++)e[c+l]=i[o+l]+256-(i[o+l-r]>>1)&255;for(l=a;l<r;l++)e[c+l]=i[o+l]+256-(i[o+l-r]+i[o+l-a]>>1)&255}if(4==s){for(l=0;l<a;l++)e[c+l]=i[o+l]+256-h(0,i[o+l-r],0)&255;for(l=a;l<r;l++)e[c+l]=i[o+l]+256-h(i[o+l-a],i[o+l-r],i[o+l-a-r])&255}}},t.crc={table:function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var i=e,n=0;n<8;n++)1&i?i=3988292384^i>>>1:i>>>=1;t[e]=i}return t}(),update:function(e,i,n,r){for(var a=0;a<r;a++)e=t.crc.table[255&(e^i[n+a])]^e>>>8;return e},crc:function(e,i,n){return 4294967295^t.crc.update(4294967295,e,i,n)}},t.quantize=function(e,i){for(var n=new Uint8Array(e),r=n.slice(0),a=new Uint32Array(r.buffer),s=t.quantize.getKDtree(r,i),o=s[0],c=s[1],h=(t.quantize.planeDst,n),l=a,d=h.length,u=new Uint8Array(n.length>>2),f=0;f<d;f+=4){var p=h[f]*(1/255),m=h[f+1]*(1/255),g=h[f+2]*(1/255),v=h[f+3]*(1/255),_=t.quantize.getNearest(o,p,m,g,v);u[f>>2]=_.ind,l[f>>2]=_.est.rgba}return{abuf:r.buffer,inds:u,plte:c}},t.quantize.getKDtree=function(e,i,n){null==n&&(n=1e-4);var r=new Uint32Array(e.buffer),a={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};a.bst=t.quantize.stats(e,a.i0,a.i1),a.est=t.quantize.estats(a.bst);for(var s=[a];s.length<i;){for(var o=0,c=0,h=0;h<s.length;h++)s[h].est.L>o&&(o=s[h].est.L,c=h);if(o<n)break;var l=s[c],d=t.quantize.splitPixels(e,r,l.i0,l.i1,l.est.e,l.est.eMq255);if(l.i0>=d||l.i1<=d)l.est.L=0;else{var u={i0:l.i0,i1:d,bst:null,est:null,tdst:0,left:null,right:null};u.bst=t.quantize.stats(e,u.i0,u.i1),u.est=t.quantize.estats(u.bst);var f={i0:d,i1:l.i1,bst:null,est:null,tdst:0,left:null,right:null};f.bst={R:[],m:[],N:l.bst.N-u.bst.N};for(h=0;h<16;h++)f.bst.R[h]=l.bst.R[h]-u.bst.R[h];for(h=0;h<4;h++)f.bst.m[h]=l.bst.m[h]-u.bst.m[h];f.est=t.quantize.estats(f.bst),l.left=u,l.right=f,s[c]=u,s.push(f)}}s.sort(function(t,e){return e.bst.N-t.bst.N});for(h=0;h<s.length;h++)s[h].ind=h;return[a,s]},t.quantize.getNearest=function(e,i,n,r,a){if(null==e.left)return e.tdst=t.quantize.dist(e.est.q,i,n,r,a),e;var s=t.quantize.planeDst(e.est,i,n,r,a),o=e.left,c=e.right;s>0&&(o=e.right,c=e.left);var h=t.quantize.getNearest(o,i,n,r,a);if(h.tdst<=s*s)return h;var l=t.quantize.getNearest(c,i,n,r,a);return l.tdst<h.tdst?l:h},t.quantize.planeDst=function(t,e,i,n,r){var a=t.e;return a[0]*e+a[1]*i+a[2]*n+a[3]*r-t.eMq},t.quantize.dist=function(t,e,i,n,r){var a=e-t[0],s=i-t[1],o=n-t[2],c=r-t[3];return a*a+s*s+o*o+c*c},t.quantize.splitPixels=function(e,i,n,r,a,s){var o=t.quantize.vecDot;r-=4;for(;n<r;){for(;o(e,n,a)<=s;)n+=4;for(;o(e,r,a)>s;)r-=4;if(n>=r)break;var c=i[n>>2];i[n>>2]=i[r>>2],i[r>>2]=c,n+=4,r-=4}for(;o(e,n,a)>s;)n-=4;return n+4},t.quantize.vecDot=function(t,e,i){return t[e]*i[0]+t[e+1]*i[1]+t[e+2]*i[2]+t[e+3]*i[3]},t.quantize.stats=function(t,e,i){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=[0,0,0,0],a=i-e>>2,s=e;s<i;s+=4){var o=t[s]*(1/255),c=t[s+1]*(1/255),h=t[s+2]*(1/255),l=t[s+3]*(1/255);r[0]+=o,r[1]+=c,r[2]+=h,r[3]+=l,n[0]+=o*o,n[1]+=o*c,n[2]+=o*h,n[3]+=o*l,n[5]+=c*c,n[6]+=c*h,n[7]+=c*l,n[10]+=h*h,n[11]+=h*l,n[15]+=l*l}return n[4]=n[1],n[8]=n[2],n[9]=n[6],n[12]=n[3],n[13]=n[7],n[14]=n[11],{R:n,m:r,N:a}},t.quantize.estats=function(e){var i=e.R,n=e.m,r=e.N,a=n[0],s=n[1],o=n[2],c=n[3],h=0==r?0:1/r,l=[i[0]-a*a*h,i[1]-a*s*h,i[2]-a*o*h,i[3]-a*c*h,i[4]-s*a*h,i[5]-s*s*h,i[6]-s*o*h,i[7]-s*c*h,i[8]-o*a*h,i[9]-o*s*h,i[10]-o*o*h,i[11]-o*c*h,i[12]-c*a*h,i[13]-c*s*h,i[14]-c*o*h,i[15]-c*c*h],d=l,u=t.M4,f=[.5,.5,.5,.5],p=0,m=0;if(0!=r)for(var g=0;g<10&&(f=u.multVec(d,f),m=Math.sqrt(u.dot(f,f)),f=u.sml(1/m,f),!(Math.abs(m-p)<1e-9));g++)p=m;var v=[a*h,s*h,o*h,c*h];return{Cov:l,q:v,e:f,L:p,eMq255:u.dot(u.sml(255,v),f),eMq:u.dot(f,v),rgba:(Math.round(255*v[3])<<24|Math.round(255*v[2])<<16|Math.round(255*v[1])<<8|Math.round(255*v[0])<<0)>>>0}},t.M4={multVec:function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},sml:function(t,e){return[t*e[0],t*e[1],t*e[2],t*e[3]]}},t.encode.concatRGBA=function(t,e){for(var i=0,n=0;n<t.length;n++)i+=t[n].byteLength;var r=new Uint8Array(i),a=0;for(n=0;n<t.length;n++){for(var s=new Uint8Array(t[n]),o=s.length,c=0;c<o;c+=4){var h=s[c],l=s[c+1],d=s[c+2],u=s[c+3];e&&(u=0==(128&u)?0:255),0==u&&(h=l=d=0),r[a+c]=h,r[a+c+1]=l,r[a+c+2]=d,r[a+c+3]=u}a+=o}return r.buffer}}(e,i(12))}()}).call(this,i(11))},function(t,e){var i,n,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var c,h=[],l=!1,d=-1;function u(){l&&c&&(l=!1,c.length?h=c.concat(h):d=-1,h.length&&f())}function f(){if(!l){var t=o(u);l=!0;for(var e=h.length;e;){for(c=h,h=[];++d<e;)c&&c[d].run();d=-1,e=h.length}c=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new p(t,e)),1!==h.length||l||o(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){"use strict";var n={};(0,i(0).assign)(n,i(13),i(16),i(8)),t.exports=n},function(t,e,i){"use strict";var n=i(14),r=i(0),a=i(6),s=i(1),o=i(7),c=Object.prototype.toString,h=0,l=-1,d=0,u=8;function f(t){if(!(this instanceof f))return new f(t);this.options=r.assign({level:l,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==h)throw new Error(s[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var p;if(p="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===c.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=n.deflateSetDictionary(this.strm,p))!==h)throw new Error(s[i]);this._dict_set=!0}}function p(t,e){var i=new f(e);if(i.push(t,!0),i.err)throw i.msg||s[i.err];return i.result}f.prototype.push=function(t,e){var i,s,o=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=a.string2buf(t):"[object ArrayBuffer]"===c.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(l),o.next_out=0,o.avail_out=l),1!==(i=n.deflate(o,s))&&i!==h)return this.onEnd(i),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==i);return 4===s?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===h):2!==s||(this.onEnd(h),o.avail_out=0,!0)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=f,e.deflate=p,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,p(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,p(t,e)}},function(t,e,i){"use strict";var n,r=i(0),a=i(15),s=i(4),o=i(5),c=i(1),h=0,l=1,d=3,u=4,f=5,p=0,m=1,g=-2,v=-3,_=-5,b=-1,w=1,y=2,x=3,k=4,S=0,C=2,z=8,B=9,A=15,E=8,R=286,D=30,q=19,T=2*R+1,L=15,I=3,F=258,P=F+I+1,U=32,M=42,W=69,O=73,N=91,H=103,j=113,G=666,Z=1,V=2,Y=3,X=4,$=3;function K(t,e){return t.msg=c[e],e}function Q(t){return(t<<1)-(t>4?9:0)}function J(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function it(t,e){t.pending_buf[t.pending++]=e}function nt(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e){var i,n,r=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,c=t.strstart>t.w_size-P?t.strstart-(t.w_size-P):0,h=t.window,l=t.w_mask,d=t.prev,u=t.strstart+F,f=h[a+s-1],p=h[a+s];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(h[(i=e)+s]===p&&h[i+s-1]===f&&h[i]===h[a]&&h[++i]===h[a+1]){a+=2,i++;do{}while(h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&h[++a]===h[++i]&&a<u);if(n=F-(u-a),a=u-F,n>s){if(t.match_start=e,s=n,n>=o)break;f=h[a+s-1],p=h[a+s]}}}while((e=d[e&l])>c&&0!=--r);return s<=t.lookahead?s:t.lookahead}function at(t){var e,i,n,a,c,h,l,d,u,f,p=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=p+(p-P)){r.arraySet(t.window,t.window,p,p,0),t.match_start-=p,t.strstart-=p,t.block_start-=p,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=p?n-p:0}while(--i);e=i=p;do{n=t.prev[--e],t.prev[e]=n>=p?n-p:0}while(--i);a+=p}if(0===t.strm.avail_in)break;if(h=t.strm,l=t.window,d=t.strstart+t.lookahead,u=a,f=void 0,(f=h.avail_in)>u&&(f=u),i=0===f?0:(h.avail_in-=f,r.arraySet(l,h.input,h.next_in,f,d),1===h.state.wrap?h.adler=s(h.adler,l,f,d):2===h.state.wrap&&(h.adler=o(h.adler,l,f,d)),h.next_in+=f,h.total_in+=f,f),t.lookahead+=i,t.lookahead+t.insert>=I)for(c=t.strstart-t.insert,t.ins_h=t.window[c],t.ins_h=(t.ins_h<<t.hash_shift^t.window[c+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[c+I-1])&t.hash_mask,t.prev[c&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=c,c++,t.insert--,!(t.lookahead+t.insert<I)););}while(t.lookahead<P&&0!==t.strm.avail_in)}function st(t,e){for(var i,n;;){if(t.lookahead<P){if(at(t),t.lookahead<P&&e===h)return Z;if(0===t.lookahead)break}if(i=0,t.lookahead>=I&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+I-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-P&&(t.match_length=rt(t,i)),t.match_length>=I)if(n=a._tr_tally(t,t.strstart-t.match_start,t.match_length-I),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=I){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+I-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=t.strstart<I-1?t.strstart:I-1,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:V}function ot(t,e){for(var i,n,r;;){if(t.lookahead<P){if(at(t),t.lookahead<P&&e===h)return Z;if(0===t.lookahead)break}if(i=0,t.lookahead>=I&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+I-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=I-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-P&&(t.match_length=rt(t,i),t.match_length<=5&&(t.strategy===w||t.match_length===I&&t.strstart-t.match_start>4096)&&(t.match_length=I-1)),t.prev_length>=I&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-I,n=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-I),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+I-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=I-1,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return Z}else if(t.match_available){if((n=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return Z}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<I-1?t.strstart:I-1,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:V}function ct(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*T),this.dyn_dtree=new r.Buf16(2*(2*D+1)),this.bl_tree=new r.Buf16(2*(2*q+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(L+1),this.heap=new r.Buf16(2*R+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*R+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lt(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=C,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?M:j,t.adler=2===e.wrap?0:1,e.last_flush=h,a._tr_init(e),p):K(t,g)}function dt(t){var e,i=lt(t);return i===p&&((e=t.state).window_size=2*e.w_size,J(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=I-1,e.match_available=0,e.ins_h=0),i}function ut(t,e,i,n,a,s){if(!t)return g;var o=1;if(e===b&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),a<1||a>B||i!==z||n<8||n>15||e<0||e>9||s<0||s>k)return K(t,g);8===n&&(n=9);var c=new ht;return t.state=c,c.strm=t,c.wrap=o,c.gzhead=null,c.w_bits=n,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+I-1)/I),c.window=new r.Buf8(2*c.w_size),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=e,c.strategy=s,c.method=i,dt(t)}n=[new ct(0,0,0,0,function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===h)return Z;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,et(t,!1),0===t.strm.avail_out))return Z;if(t.strstart-t.block_start>=t.w_size-P&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),Z)}),new ct(4,4,8,4,st),new ct(4,5,16,8,st),new ct(4,6,32,32,st),new ct(4,4,16,16,ot),new ct(8,16,32,32,ot),new ct(8,16,128,128,ot),new ct(8,32,128,256,ot),new ct(32,128,258,1024,ot),new ct(32,258,258,4096,ot)],e.deflateInit=function(t,e){return ut(t,e,z,A,E,S)},e.deflateInit2=ut,e.deflateReset=dt,e.deflateResetKeep=lt,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?g:(t.state.gzhead=e,p):g},e.deflate=function(t,e){var i,r,s,c;if(!t||!t.state||e>f||e<0)return t?K(t,g):g;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===G&&e!==u)return K(t,0===t.avail_out?_:g);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===M)if(2===r.wrap)t.adler=0,it(r,31),it(r,139),it(r,8),r.gzhead?(it(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),it(r,255&r.gzhead.time),it(r,r.gzhead.time>>8&255),it(r,r.gzhead.time>>16&255),it(r,r.gzhead.time>>24&255),it(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),it(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(it(r,255&r.gzhead.extra.length),it(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=o(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=W):(it(r,0),it(r,0),it(r,0),it(r,0),it(r,0),it(r,9===r.level?2:r.strategy>=y||r.level<2?4:0),it(r,$),r.status=j);else{var v=z+(r.w_bits-8<<4)<<8;v|=(r.strategy>=y||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(v|=U),v+=31-v%31,r.status=j,nt(r,v),0!==r.strstart&&(nt(r,t.adler>>>16),nt(r,65535&t.adler)),t.adler=1}if(r.status===W)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending!==r.pending_buf_size));)it(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=O)}else r.status=O;if(r.status===O)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,it(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.gzindex=0,r.status=N)}else r.status=N;if(r.status===N)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),tt(t),s=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,it(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>s&&(t.adler=o(t.adler,r.pending_buf,r.pending-s,s)),0===c&&(r.status=H)}else r.status=H;if(r.status===H&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&tt(t),r.pending+2<=r.pending_buf_size&&(it(r,255&t.adler),it(r,t.adler>>8&255),t.adler=0,r.status=j)):r.status=j),0!==r.pending){if(tt(t),0===t.avail_out)return r.last_flush=-1,p}else if(0===t.avail_in&&Q(e)<=Q(i)&&e!==u)return K(t,_);if(r.status===G&&0!==t.avail_in)return K(t,_);if(0!==t.avail_in||0!==r.lookahead||e!==h&&r.status!==G){var b=r.strategy===y?function(t,e){for(var i;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===h)return Z;break}if(t.match_length=0,i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:V}(r,e):r.strategy===x?function(t,e){for(var i,n,r,s,o=t.window;;){if(t.lookahead<=F){if(at(t),t.lookahead<=F&&e===h)return Z;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=I&&t.strstart>0&&(n=o[r=t.strstart-1])===o[++r]&&n===o[++r]&&n===o[++r]){s=t.strstart+F;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=F-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=I?(i=a._tr_tally(t,1,t.match_length-I),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(et(t,!1),0===t.strm.avail_out))return Z}return t.insert=0,e===u?(et(t,!0),0===t.strm.avail_out?Y:X):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?Z:V}(r,e):n[r.level].func(r,e);if(b!==Y&&b!==X||(r.status=G),b===Z||b===Y)return 0===t.avail_out&&(r.last_flush=-1),p;if(b===V&&(e===l?a._tr_align(r):e!==f&&(a._tr_stored_block(r,0,0,!1),e===d&&(J(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),tt(t),0===t.avail_out))return r.last_flush=-1,p}return e!==u?p:r.wrap<=0?m:(2===r.wrap?(it(r,255&t.adler),it(r,t.adler>>8&255),it(r,t.adler>>16&255),it(r,t.adler>>24&255),it(r,255&t.total_in),it(r,t.total_in>>8&255),it(r,t.total_in>>16&255),it(r,t.total_in>>24&255)):(nt(r,t.adler>>>16),nt(r,65535&t.adler)),tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:m)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==M&&e!==W&&e!==O&&e!==N&&e!==H&&e!==j&&e!==G?K(t,g):(t.state=null,e===j?K(t,v):p):g},e.deflateSetDictionary=function(t,e){var i,n,a,o,c,h,l,d,u=e.length;if(!t||!t.state)return g;if(2===(o=(i=t.state).wrap)||1===o&&i.status!==M||i.lookahead)return g;for(1===o&&(t.adler=s(t.adler,e,u,0)),i.wrap=0,u>=i.w_size&&(0===o&&(J(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new r.Buf8(i.w_size),r.arraySet(d,e,u-i.w_size,i.w_size,0),e=d,u=i.w_size),c=t.avail_in,h=t.next_in,l=t.input,t.avail_in=u,t.next_in=0,t.input=e,at(i);i.lookahead>=I;){n=i.strstart,a=i.lookahead-(I-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+I-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--a);i.strstart=n,i.lookahead=I-1,at(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=I-1,i.match_available=0,t.next_in=h,t.input=l,t.avail_in=c,i.wrap=o,p},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,i){"use strict";var n=i(0),r=4,a=0,s=1,o=2;function c(t){for(var e=t.length;--e>=0;)t[e]=0}var h=0,l=1,d=2,u=29,f=256,p=f+1+u,m=30,g=19,v=2*p+1,_=15,b=16,w=7,y=256,x=16,k=17,S=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=new Array(2*(p+2));c(E);var R=new Array(2*m);c(R);var D=new Array(512);c(D);var q=new Array(256);c(q);var T=new Array(u);c(T);var L,I,F,P=new Array(m);function U(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function M(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function W(t){return t<256?D[t]:D[256+(t>>>7)]}function O(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function N(t,e,i){t.bi_valid>b-i?(t.bi_buf|=e<<t.bi_valid&65535,O(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=i-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function H(t,e,i){N(t,i[2*e],i[2*e+1])}function j(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function G(t,e,i){var n,r,a=new Array(_+1),s=0;for(n=1;n<=_;n++)a[n]=s=s+i[n-1]<<1;for(r=0;r<=e;r++){var o=t[2*r+1];0!==o&&(t[2*r]=j(a[o]++,o))}}function Z(t){var e;for(e=0;e<p;e++)t.dyn_ltree[2*e]=0;for(e=0;e<m;e++)t.dyn_dtree[2*e]=0;for(e=0;e<g;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function V(t){t.bi_valid>8?O(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function Y(t,e,i,n){var r=2*e,a=2*i;return t[r]<t[a]||t[r]===t[a]&&n[e]<=n[i]}function X(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&Y(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!Y(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function $(t,e,i){var n,r,a,s,o=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],r=t.pending_buf[t.l_buf+o],o++,0===n?H(t,r,e):(H(t,(a=q[r])+f+1,e),0!==(s=C[a])&&N(t,r-=T[a],s),H(t,a=W(--n),i),0!==(s=z[a])&&N(t,n-=P[a],s))}while(o<t.last_lit);H(t,y,e)}function K(t,e){var i,n,r,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,c=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=v,i=0;i<c;i++)0!==a[2*i]?(t.heap[++t.heap_len]=h=i,t.depth[i]=0):a[2*i+1]=0;for(;t.heap_len<2;)a[2*(r=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=s[2*r+1]);for(e.max_code=h,i=t.heap_len>>1;i>=1;i--)X(t,a,i);r=c;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],X(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,a[2*r]=a[2*i]+a[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,a[2*i+1]=a[2*n+1]=r,t.heap[1]=r++,X(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,a,s,o,c=e.dyn_tree,h=e.max_code,l=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(a=0;a<=_;a++)t.bl_count[a]=0;for(c[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<v;i++)(a=c[2*c[2*(n=t.heap[i])+1]+1]+1)>p&&(a=p,m++),c[2*n+1]=a,n>h||(t.bl_count[a]++,s=0,n>=f&&(s=u[n-f]),o=c[2*n],t.opt_len+=o*(a+s),d&&(t.static_len+=o*(l[2*n+1]+s)));if(0!==m){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(n=t.bl_count[a];0!==n;)(r=t.heap[--i])>h||(c[2*r+1]!==a&&(t.opt_len+=(a-c[2*r+1])*c[2*r],c[2*r+1]=a),n--)}}(t,e),G(a,h,t.bl_count)}function Q(t,e,i){var n,r,a=-1,s=e[1],o=0,c=7,h=4;for(0===s&&(c=138,h=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=s,s=e[2*(n+1)+1],++o<c&&r===s||(o<h?t.bl_tree[2*r]+=o:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[2*x]++):o<=10?t.bl_tree[2*k]++:t.bl_tree[2*S]++,o=0,a=r,0===s?(c=138,h=3):r===s?(c=6,h=3):(c=7,h=4))}function J(t,e,i){var n,r,a=-1,s=e[1],o=0,c=7,h=4;for(0===s&&(c=138,h=3),n=0;n<=i;n++)if(r=s,s=e[2*(n+1)+1],!(++o<c&&r===s)){if(o<h)do{H(t,r,t.bl_tree)}while(0!=--o);else 0!==r?(r!==a&&(H(t,r,t.bl_tree),o--),H(t,x,t.bl_tree),N(t,o-3,2)):o<=10?(H(t,k,t.bl_tree),N(t,o-3,3)):(H(t,S,t.bl_tree),N(t,o-11,7));o=0,a=r,0===s?(c=138,h=3):r===s?(c=6,h=3):(c=7,h=4)}}c(P);var tt=!1;function et(t,e,i,r){N(t,(h<<1)+(r?1:0),3),function(t,e,i,r){V(t),r&&(O(t,i),O(t,~i)),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i,!0)}e._tr_init=function(t){tt||(function(){var t,e,i,n,r,a=new Array(_+1);for(i=0,n=0;n<u-1;n++)for(T[n]=i,t=0;t<1<<C[n];t++)q[i++]=n;for(q[i-1]=n,r=0,n=0;n<16;n++)for(P[n]=r,t=0;t<1<<z[n];t++)D[r++]=n;for(r>>=7;n<m;n++)for(P[n]=r<<7,t=0;t<1<<z[n]-7;t++)D[256+r++]=n;for(e=0;e<=_;e++)a[e]=0;for(t=0;t<=143;)E[2*t+1]=8,t++,a[8]++;for(;t<=255;)E[2*t+1]=9,t++,a[9]++;for(;t<=279;)E[2*t+1]=7,t++,a[7]++;for(;t<=287;)E[2*t+1]=8,t++,a[8]++;for(G(E,p+1,a),t=0;t<m;t++)R[2*t+1]=5,R[2*t]=j(t,5);L=new U(E,C,f+1,p,_),I=new U(R,z,0,m,_),F=new U(new Array(0),B,0,g,w)}(),tt=!0),t.l_desc=new M(t.dyn_ltree,L),t.d_desc=new M(t.dyn_dtree,I),t.bl_desc=new M(t.bl_tree,F),t.bi_buf=0,t.bi_valid=0,Z(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,i,n){var c,h,u=0;t.level>0?(t.strm.data_type===o&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return s;return a}(t)),K(t,t.l_desc),K(t,t.d_desc),u=function(t){var e;for(Q(t,t.dyn_ltree,t.l_desc.max_code),Q(t,t.dyn_dtree,t.d_desc.max_code),K(t,t.bl_desc),e=g-1;e>=3&&0===t.bl_tree[2*A[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),c=t.opt_len+3+7>>>3,(h=t.static_len+3+7>>>3)<=c&&(c=h)):c=h=i+5,i+4<=c&&-1!==e?et(t,e,i,n):t.strategy===r||h===c?(N(t,(l<<1)+(n?1:0),3),$(t,E,R)):(N(t,(d<<1)+(n?1:0),3),function(t,e,i,n){var r;for(N(t,e-257,5),N(t,i-1,5),N(t,n-4,4),r=0;r<n;r++)N(t,t.bl_tree[2*A[r]+1],3);J(t,t.dyn_ltree,e-1),J(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,u+1),$(t,t.dyn_ltree,t.dyn_dtree)),Z(t),n&&V(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(q[i]+f+1)]++,t.dyn_dtree[2*W(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){N(t,l<<1,3),H(t,y,E),function(t){16===t.bi_valid?(O(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,i){"use strict";var n=i(17),r=i(0),a=i(6),s=i(8),o=i(1),c=i(7),h=i(20),l=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==s.Z_OK)throw new Error(o[i]);if(this.header=new h,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=n.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(o[i])}function u(t,e){var i=new d(e);if(i.push(t,!0),i.err)throw i.msg||o[i.err];return i.result}d.prototype.push=function(t,e){var i,o,c,h,d,u=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?u.input=a.binstring2buf(t):"[object ArrayBuffer]"===l.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new r.Buf8(f),u.next_out=0,u.avail_out=f),(i=n.inflate(u,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(i=n.inflateSetDictionary(this.strm,p)),i===s.Z_BUF_ERROR&&!0===m&&(i=s.Z_OK,m=!1),i!==s.Z_STREAM_END&&i!==s.Z_OK)return this.onEnd(i),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&i!==s.Z_STREAM_END&&(0!==u.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(u.output,u.next_out),h=u.next_out-c,d=a.buf2string(u.output,c),u.next_out=h,u.avail_out=f-h,h&&r.arraySet(u.output,u.output,c,h,0),this.onData(d)):this.onData(r.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(m=!0)}while((u.avail_in>0||0===u.avail_out)&&i!==s.Z_STREAM_END);return i===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=d,e.inflate=u,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},e.ungzip=u},function(t,e,i){"use strict";var n=i(0),r=i(4),a=i(5),s=i(18),o=i(19),c=0,h=1,l=2,d=4,u=5,f=6,p=0,m=1,g=2,v=-2,_=-3,b=-4,w=-5,y=8,x=1,k=2,S=3,C=4,z=5,B=6,A=7,E=8,R=9,D=10,q=11,T=12,L=13,I=14,F=15,P=16,U=17,M=18,W=19,O=20,N=21,H=22,j=23,G=24,Z=25,V=26,Y=27,X=28,$=29,K=30,Q=31,J=32,tt=852,et=592,it=15;function nt(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function at(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=x,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(tt),e.distcode=e.distdyn=new n.Buf32(et),e.sane=1,e.back=-1,p):v}function st(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,at(t)):v}function ot(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?v:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,st(t))):v}function ct(t,e){var i,n;return t?(n=new rt,t.state=n,n.window=null,(i=ot(t,e))!==p&&(t.state=null),i):v}var ht,lt,dt=!0;function ut(t){if(dt){var e;for(ht=new n.Buf32(512),lt=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(h,t.lens,0,288,ht,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(l,t.lens,0,32,lt,0,t.work,{bits:5}),dt=!1}t.lencode=ht,t.lenbits=9,t.distcode=lt,t.distbits=5}function ft(t,e,i,r){var a,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),r>=s.wsize?(n.arraySet(s.window,e,i-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>r&&(a=r),n.arraySet(s.window,e,i-r,a,s.wnext),(r-=a)?(n.arraySet(s.window,e,i-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}e.inflateReset=st,e.inflateReset2=ot,e.inflateResetKeep=at,e.inflateInit=function(t){return ct(t,it)},e.inflateInit2=ct,e.inflate=function(t,e){var i,tt,et,it,rt,at,st,ot,ct,ht,lt,dt,pt,mt,gt,vt,_t,bt,wt,yt,xt,kt,St,Ct,zt=0,Bt=new n.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return v;(i=t.state).mode===T&&(i.mode=L),rt=t.next_out,et=t.output,st=t.avail_out,it=t.next_in,tt=t.input,at=t.avail_in,ot=i.hold,ct=i.bits,ht=at,lt=st,kt=p;t:for(;;)switch(i.mode){case x:if(0===i.wrap){i.mode=L;break}for(;ct<16;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(2&i.wrap&&35615===ot){i.check=0,Bt[0]=255&ot,Bt[1]=ot>>>8&255,i.check=a(i.check,Bt,2,0),ot=0,ct=0,i.mode=k;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&ot)<<8)+(ot>>8))%31){t.msg="incorrect header check",i.mode=K;break}if((15&ot)!==y){t.msg="unknown compression method",i.mode=K;break}if(ct-=4,xt=8+(15&(ot>>>=4)),0===i.wbits)i.wbits=xt;else if(xt>i.wbits){t.msg="invalid window size",i.mode=K;break}i.dmax=1<<xt,t.adler=i.check=1,i.mode=512&ot?D:T,ot=0,ct=0;break;case k:for(;ct<16;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(i.flags=ot,(255&i.flags)!==y){t.msg="unknown compression method",i.mode=K;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=K;break}i.head&&(i.head.text=ot>>8&1),512&i.flags&&(Bt[0]=255&ot,Bt[1]=ot>>>8&255,i.check=a(i.check,Bt,2,0)),ot=0,ct=0,i.mode=S;case S:for(;ct<32;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.head&&(i.head.time=ot),512&i.flags&&(Bt[0]=255&ot,Bt[1]=ot>>>8&255,Bt[2]=ot>>>16&255,Bt[3]=ot>>>24&255,i.check=a(i.check,Bt,4,0)),ot=0,ct=0,i.mode=C;case C:for(;ct<16;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.head&&(i.head.xflags=255&ot,i.head.os=ot>>8),512&i.flags&&(Bt[0]=255&ot,Bt[1]=ot>>>8&255,i.check=a(i.check,Bt,2,0)),ot=0,ct=0,i.mode=z;case z:if(1024&i.flags){for(;ct<16;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.length=ot,i.head&&(i.head.extra_len=ot),512&i.flags&&(Bt[0]=255&ot,Bt[1]=ot>>>8&255,i.check=a(i.check,Bt,2,0)),ot=0,ct=0}else i.head&&(i.head.extra=null);i.mode=B;case B:if(1024&i.flags&&((dt=i.length)>at&&(dt=at),dt&&(i.head&&(xt=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,tt,it,dt,xt)),512&i.flags&&(i.check=a(i.check,tt,dt,it)),at-=dt,it+=dt,i.length-=dt),i.length))break t;i.length=0,i.mode=A;case A:if(2048&i.flags){if(0===at)break t;dt=0;do{xt=tt[it+dt++],i.head&&xt&&i.length<65536&&(i.head.name+=String.fromCharCode(xt))}while(xt&&dt<at);if(512&i.flags&&(i.check=a(i.check,tt,dt,it)),at-=dt,it+=dt,xt)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=E;case E:if(4096&i.flags){if(0===at)break t;dt=0;do{xt=tt[it+dt++],i.head&&xt&&i.length<65536&&(i.head.comment+=String.fromCharCode(xt))}while(xt&&dt<at);if(512&i.flags&&(i.check=a(i.check,tt,dt,it)),at-=dt,it+=dt,xt)break t}else i.head&&(i.head.comment=null);i.mode=R;case R:if(512&i.flags){for(;ct<16;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(ot!==(65535&i.check)){t.msg="header crc mismatch",i.mode=K;break}ot=0,ct=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=T;break;case D:for(;ct<32;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}t.adler=i.check=nt(ot),ot=0,ct=0,i.mode=q;case q:if(0===i.havedict)return t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=at,i.hold=ot,i.bits=ct,g;t.adler=i.check=1,i.mode=T;case T:if(e===u||e===f)break t;case L:if(i.last){ot>>>=7&ct,ct-=7&ct,i.mode=Y;break}for(;ct<3;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}switch(i.last=1&ot,ct-=1,3&(ot>>>=1)){case 0:i.mode=I;break;case 1:if(ut(i),i.mode=O,e===f){ot>>>=2,ct-=2;break t}break;case 2:i.mode=U;break;case 3:t.msg="invalid block type",i.mode=K}ot>>>=2,ct-=2;break;case I:for(ot>>>=7&ct,ct-=7&ct;ct<32;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if((65535&ot)!=(ot>>>16^65535)){t.msg="invalid stored block lengths",i.mode=K;break}if(i.length=65535&ot,ot=0,ct=0,i.mode=F,e===f)break t;case F:i.mode=P;case P:if(dt=i.length){if(dt>at&&(dt=at),dt>st&&(dt=st),0===dt)break t;n.arraySet(et,tt,it,dt,rt),at-=dt,it+=dt,st-=dt,rt+=dt,i.length-=dt;break}i.mode=T;break;case U:for(;ct<14;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(i.nlen=257+(31&ot),ot>>>=5,ct-=5,i.ndist=1+(31&ot),ot>>>=5,ct-=5,i.ncode=4+(15&ot),ot>>>=4,ct-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=K;break}i.have=0,i.mode=M;case M:for(;i.have<i.ncode;){for(;ct<3;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.lens[At[i.have++]]=7&ot,ot>>>=3,ct-=3}for(;i.have<19;)i.lens[At[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,St={bits:i.lenbits},kt=o(c,i.lens,0,19,i.lencode,0,i.work,St),i.lenbits=St.bits,kt){t.msg="invalid code lengths set",i.mode=K;break}i.have=0,i.mode=W;case W:for(;i.have<i.nlen+i.ndist;){for(;vt=(zt=i.lencode[ot&(1<<i.lenbits)-1])>>>16&255,_t=65535&zt,!((gt=zt>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(_t<16)ot>>>=gt,ct-=gt,i.lens[i.have++]=_t;else{if(16===_t){for(Ct=gt+2;ct<Ct;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(ot>>>=gt,ct-=gt,0===i.have){t.msg="invalid bit length repeat",i.mode=K;break}xt=i.lens[i.have-1],dt=3+(3&ot),ot>>>=2,ct-=2}else if(17===_t){for(Ct=gt+3;ct<Ct;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}ct-=gt,xt=0,dt=3+(7&(ot>>>=gt)),ot>>>=3,ct-=3}else{for(Ct=gt+7;ct<Ct;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}ct-=gt,xt=0,dt=11+(127&(ot>>>=gt)),ot>>>=7,ct-=7}if(i.have+dt>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=K;break}for(;dt--;)i.lens[i.have++]=xt}}if(i.mode===K)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=K;break}if(i.lenbits=9,St={bits:i.lenbits},kt=o(h,i.lens,0,i.nlen,i.lencode,0,i.work,St),i.lenbits=St.bits,kt){t.msg="invalid literal/lengths set",i.mode=K;break}if(i.distbits=6,i.distcode=i.distdyn,St={bits:i.distbits},kt=o(l,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,St),i.distbits=St.bits,kt){t.msg="invalid distances set",i.mode=K;break}if(i.mode=O,e===f)break t;case O:i.mode=N;case N:if(at>=6&&st>=258){t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=at,i.hold=ot,i.bits=ct,s(t,lt),rt=t.next_out,et=t.output,st=t.avail_out,it=t.next_in,tt=t.input,at=t.avail_in,ot=i.hold,ct=i.bits,i.mode===T&&(i.back=-1);break}for(i.back=0;vt=(zt=i.lencode[ot&(1<<i.lenbits)-1])>>>16&255,_t=65535&zt,!((gt=zt>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(vt&&0==(240&vt)){for(bt=gt,wt=vt,yt=_t;vt=(zt=i.lencode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,_t=65535&zt,!(bt+(gt=zt>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}ot>>>=bt,ct-=bt,i.back+=bt}if(ot>>>=gt,ct-=gt,i.back+=gt,i.length=_t,0===vt){i.mode=V;break}if(32&vt){i.back=-1,i.mode=T;break}if(64&vt){t.msg="invalid literal/length code",i.mode=K;break}i.extra=15&vt,i.mode=H;case H:if(i.extra){for(Ct=i.extra;ct<Ct;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.length+=ot&(1<<i.extra)-1,ot>>>=i.extra,ct-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=j;case j:for(;vt=(zt=i.distcode[ot&(1<<i.distbits)-1])>>>16&255,_t=65535&zt,!((gt=zt>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(0==(240&vt)){for(bt=gt,wt=vt,yt=_t;vt=(zt=i.distcode[yt+((ot&(1<<bt+wt)-1)>>bt)])>>>16&255,_t=65535&zt,!(bt+(gt=zt>>>24)<=ct);){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}ot>>>=bt,ct-=bt,i.back+=bt}if(ot>>>=gt,ct-=gt,i.back+=gt,64&vt){t.msg="invalid distance code",i.mode=K;break}i.offset=_t,i.extra=15&vt,i.mode=G;case G:if(i.extra){for(Ct=i.extra;ct<Ct;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}i.offset+=ot&(1<<i.extra)-1,ot>>>=i.extra,ct-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=K;break}i.mode=Z;case Z:if(0===st)break t;if(dt=lt-st,i.offset>dt){if((dt=i.offset-dt)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=K;break}dt>i.wnext?(dt-=i.wnext,pt=i.wsize-dt):pt=i.wnext-dt,dt>i.length&&(dt=i.length),mt=i.window}else mt=et,pt=rt-i.offset,dt=i.length;dt>st&&(dt=st),st-=dt,i.length-=dt;do{et[rt++]=mt[pt++]}while(--dt);0===i.length&&(i.mode=N);break;case V:if(0===st)break t;et[rt++]=i.length,st--,i.mode=N;break;case Y:if(i.wrap){for(;ct<32;){if(0===at)break t;at--,ot|=tt[it++]<<ct,ct+=8}if(lt-=st,t.total_out+=lt,i.total+=lt,lt&&(t.adler=i.check=i.flags?a(i.check,et,lt,rt-lt):r(i.check,et,lt,rt-lt)),lt=st,(i.flags?ot:nt(ot))!==i.check){t.msg="incorrect data check",i.mode=K;break}ot=0,ct=0}i.mode=X;case X:if(i.wrap&&i.flags){for(;ct<32;){if(0===at)break t;at--,ot+=tt[it++]<<ct,ct+=8}if(ot!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=K;break}ot=0,ct=0}i.mode=$;case $:kt=m;break t;case K:kt=_;break t;case Q:return b;case J:default:return v}return t.next_out=rt,t.avail_out=st,t.next_in=it,t.avail_in=at,i.hold=ot,i.bits=ct,(i.wsize||lt!==t.avail_out&&i.mode<K&&(i.mode<Y||e!==d))&&ft(t,t.output,t.next_out,lt-t.avail_out)?(i.mode=Q,b):(ht-=t.avail_in,lt-=t.avail_out,t.total_in+=ht,t.total_out+=lt,i.total+=lt,i.wrap&&lt&&(t.adler=i.check=i.flags?a(i.check,et,lt,t.next_out-lt):r(i.check,et,lt,t.next_out-lt)),t.data_type=i.bits+(i.last?64:0)+(i.mode===T?128:0)+(i.mode===O||i.mode===F?256:0),(0===ht&&0===lt||e===d)&&kt===p&&(kt=w),kt)},e.inflateEnd=function(t){if(!t||!t.state)return v;var e=t.state;return e.window&&(e.window=null),t.state=null,p},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?v:(i.head=e,e.done=!1,p):v},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&i.mode!==q?v:i.mode===q&&r(1,e,n,0)!==i.check?_:ft(t,e,n,n)?(i.mode=Q,b):(i.havedict=1,p):v},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,i){"use strict";t.exports=function(t,e){var i,n,r,a,s,o,c,h,l,d,u,f,p,m,g,v,_,b,w,y,x,k,S,C,z;i=t.state,n=t.next_in,C=t.input,r=n+(t.avail_in-5),a=t.next_out,z=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),c=i.dmax,h=i.wsize,l=i.whave,d=i.wnext,u=i.window,f=i.hold,p=i.bits,m=i.lencode,g=i.distcode,v=(1<<i.lenbits)-1,_=(1<<i.distbits)-1;t:do{p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=m[f&v];e:for(;;){if(f>>>=w=b>>>24,p-=w,0===(w=b>>>16&255))z[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=m[(65535&b)+(f&(1<<w)-1)];continue e}if(32&w){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}y=65535&b,(w&=15)&&(p<w&&(f+=C[n++]<<p,p+=8),y+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=C[n++]<<p,p+=8,f+=C[n++]<<p,p+=8),b=g[f&_];i:for(;;){if(f>>>=w=b>>>24,p-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=g[(65535&b)+(f&(1<<w)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(x=65535&b,p<(w&=15)&&(f+=C[n++]<<p,(p+=8)<w&&(f+=C[n++]<<p,p+=8)),(x+=f&(1<<w)-1)>c){t.msg="invalid distance too far back",i.mode=30;break t}if(f>>>=w,p-=w,x>(w=a-s)){if((w=x-w)>l&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(k=0,S=u,0===d){if(k+=h-w,w<y){y-=w;do{z[a++]=u[k++]}while(--w);k=a-x,S=z}}else if(d<w){if(k+=h+d-w,(w-=d)<y){y-=w;do{z[a++]=u[k++]}while(--w);if(k=0,d<y){y-=w=d;do{z[a++]=u[k++]}while(--w);k=a-x,S=z}}}else if(k+=d-w,w<y){y-=w;do{z[a++]=u[k++]}while(--w);k=a-x,S=z}for(;y>2;)z[a++]=S[k++],z[a++]=S[k++],z[a++]=S[k++],y-=3;y&&(z[a++]=S[k++],y>1&&(z[a++]=S[k++]))}else{k=a-x;do{z[a++]=z[k++],z[a++]=z[k++],z[a++]=z[k++],y-=3}while(y>2);y&&(z[a++]=z[k++],y>1&&(z[a++]=z[k++]))}break}}break}}while(n<r&&a<o);n-=y=p>>3,f&=(1<<(p-=y<<3))-1,t.next_in=n,t.next_out=a,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=a<o?o-a+257:257-(a-o),i.hold=f,i.bits=p}},function(t,e,i){"use strict";var n=i(0),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,c,h,l,d,u){var f,p,m,g,v,_,b,w,y,x=u.bits,k=0,S=0,C=0,z=0,B=0,A=0,E=0,R=0,D=0,q=0,T=null,L=0,I=new n.Buf16(16),F=new n.Buf16(16),P=null,U=0;for(k=0;k<=15;k++)I[k]=0;for(S=0;S<c;S++)I[e[i+S]]++;for(B=x,z=15;z>=1&&0===I[z];z--);if(B>z&&(B=z),0===z)return h[l++]=20971520,h[l++]=20971520,u.bits=1,0;for(C=1;C<z&&0===I[C];C++);for(B<C&&(B=C),R=1,k=1;k<=15;k++)if(R<<=1,(R-=I[k])<0)return-1;if(R>0&&(0===t||1!==z))return-1;for(F[1]=0,k=1;k<15;k++)F[k+1]=F[k]+I[k];for(S=0;S<c;S++)0!==e[i+S]&&(d[F[e[i+S]]++]=S);if(0===t?(T=P=d,_=19):1===t?(T=r,L-=257,P=a,U-=257,_=256):(T=s,P=o,_=-1),q=0,S=0,k=C,v=l,A=B,E=0,m=-1,g=(D=1<<B)-1,1===t&&D>852||2===t&&D>592)return 1;for(;;){b=k-E,d[S]<_?(w=0,y=d[S]):d[S]>_?(w=P[U+d[S]],y=T[L+d[S]]):(w=96,y=0),f=1<<k-E,C=p=1<<A;do{h[v+(q>>E)+(p-=f)]=b<<24|w<<16|y|0}while(0!==p);for(f=1<<k-1;q&f;)f>>=1;if(0!==f?(q&=f-1,q+=f):q=0,S++,0==--I[k]){if(k===z)break;k=e[i+d[S]]}if(k>B&&(q&g)!==m){for(0===E&&(E=B),v+=C,R=1<<(A=k-E);A+E<z&&!((R-=I[A+E])<=0);)A++,R<<=1;if(D+=1<<A,1===t&&D>852||2===t&&D>592)return 1;h[m=q&g]=B<<24|A<<16|v-l|0}}return 0!==q&&(h[v+q]=k-E<<24|64<<16|0),u.bits=B,0}},function(t,e,i){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,i){var n=i(22);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(3)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(2)(!1)).push([t.i,'* {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\nhtml {\n  font-family: "Titillium Web", "Roboto", "Open Sans";\n  font-weight: 400;\n  font-size: 100%;\n}\n\na {\n  text-decoration: none;\n}\n\nli {\n  list-style-type: none;\n}\n\nbody {\n  background-color: #1d1d1d;\n  user-select:none;\n}\n\ninput {\n  border: none;\n  background-image: none;\n  background-color: transparent;\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n}\n\ninput:focus {\n  outline: none;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  width: 100%;\n}\n\n.column {\n  display: flex;\n  flex-direction: column;\n}\n\n/* HEADER */\n.header {\n  height: 38px;\n  font-size: 14px;\n  color: #fff;\n  background-color: #2d2d2d;\n}\n\n.header__logo {\n  margin: 5px 0 5px 20px;\n}\n\n/* MAIN */\n.main {\n  margin: 5px auto;\n  /* height: 90vh; */\n}\n\n/* TOOLS */\n.tools {\n  display: flex;\n  justify-content: flex-start;\n  width: 100px;\n}\n\n.tools__pen-size {\n  display: flex;\n  justify-content: space-around;\n  margin-top: 60px;\n}\n\n.tools__pen-size__item {\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border: 2px solid;\n  border-color: #444;\n}\n\n.tools__pen-size__item:hover {\n  border-color: #888;\n  cursor: pointer;\n}\n\n.first-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 5px;\n  left: 5px;\n  width: 6px;\n  height: 6px;\n  background-color: #fff;\n}\n\n.second-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 4px;\n  left: 4px;\n  width: 8px;\n  height: 8px;\n  background-color: #fff;\n}\n\n.third-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 3px;\n  left: 3px;\n  width: 10px;\n  height: 10px;\n  background-color: #fff;\n}\n\n.fourth-size-pen:before {\n  content: "";\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 12px;\n  height: 12px;\n  background-color: #fff;\n}\n\n.tools__wrapper {\n  margin: 5px auto;\n}\n\n.tools__item {\n  margin: 1px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.tools__item:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.tools__item i {\n  font-size: 24px;\n  color: #fff;\n}\n\n.highlight {\n  border-color: #ffd700;\n}\n\n.highlight:hover {\n  border-color: #ffd700;\n}\n\n.highlight_tool {\n  border-color: #ffd700;\n}\n\n.highlight_tool:hover {\n  border-color: #ffd700;\n}\n\n.tools__item .out-of-order {\n  color: #888888;\n}\n\n/* FRAMES */\n/* look at frames.css in components/frames folder */\n\n/* CANVAS */\n.canvas {\n  flex: 1;\n  background: rgb(160, 160, 160);\n}\n\n.canvas__background {\n  position: relative;\n  margin: auto auto;\n  /* width: 608px;\n  height: 608px; */\n  /* height: 90vh; */\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC)\n    repeat;\n}\n\n.canvas__item {\n  margin: 0 auto;\n  background: transparent;\n}\n\n.canvas__buffer {\n  position: absolute;\n  top: 0;\n  margin: auto;\n  background: transparent;\n}\n\n/* PREVIEW */\n.preview {\n  display: flex;\n  justify-content: space-between;\n  width: 230px;\n}\n\n.preview__fps-wrapper {\n  margin: 0 auto;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  background-color: rgb(51, 51, 51);\n  width: 200px;\n  height: 27px;\n}\n\n.preview__background {\n  margin: 0 auto;\n  width: 200px;\n  height: 200px;\n  align-self: center;\n  box-sizing: border-box;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC)\n    repeat;\n  /* background-position: center;\n  background-size: contain; */\n}\n\n.preview__item {\n  display: flex;\n  justify-content: flex-end;\n  width: 200px;\n  height: 200px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: contain;\n}\n\n.preview__item i {\n  display: none;\n  margin: 7px 7px 0 0;\n  font-size: 22px;\n  color: #fff;\n  cursor: pointer;\n}\n\n.preview__fps-number {\n  color: rgb(170, 170, 170);\n  font-size: 14px;\n}\n\n.preview__data-wrapper {\n  display: flex;\n}\n\n.preview__data {\n  margin-left: 10px;\n  font-size: 13px;\n  color: #ffd700;\n}\n\n.preview__transform-wrapper {\n  margin: 10px 15px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: wrap;\n  background-color: #222222;\n  width: 155px;\n  height: 85px;\n  border: 2px solid #888888;\n}\n\n.transform__title {\n  padding-top: 5px;\n  width: 100%;\n  height: 32px;\n  text-align: center;\n  color: #fff;\n  font-weight: 700;\n}\n\n.transform__buttons-wrapper {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n\n.transform-button {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 32px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.transform-button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n/* FULLSCREEN */\n.preview__item:fullscreen {\n  background-color: rgb(255, 255, 255);\n}\n.preview__item:-webkit-full-screen {\n  background-color: rgb(255, 255, 255);\n}\n.preview__item:-moz-full-screen {\n  background-color: rgb(255, 255, 255);\n}\n\n\n/* FRAME CONTROLS */\n.features {\n  position: relative;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  width: 50px;\n  height: 608px;\n}\n\n.features__button {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 32px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.features__button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.features__button:not(:first-child) {\n  margin-top: 10px;\n}\n\n.resize__info {\n  margin-top: 5px;\n  color: #fff;\n  font-size: 11px;\n}\n\n/* Download buttons */\n\n.download__button {\n  position: relative;\n  margin-top: 10px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 48px;\n  height: 48px;\n  color: #fff;\n  font-size: 21px;\n  transform: translate(0px, 0px);\n  transition:transform 0.3s ease;\n  border: 3px solid;\n  border-color: #3a3a3a;\n  background-color: #3a3a3a;\n  cursor: pointer;\n}\n\n.download__button:hover {\n  border-color: #444;\n  background-color: #444;\n}\n\n.apng__download {\n  font-size: 18px;\n}\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,a=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,i){var n=i(25);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(3)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(2)(!1)).push([t.i,".tools__picker-container {\n  position: relative;\n}\n\n.tools__picker-item {\n  position: absolute;\n  width: 48px;\n  height: 48px;\n  background-color: rgb(68, 68, 68);\n  cursor: pointer;\n}\n\n.tools__picker-item:hover {\n  background-color: rgb(136, 136, 136);\n}\n\n.primary-color {\n  top: 5px;\n  left: 10px;\n}\n\n.secondary-color {\n  top: 35px;\n  left: 35px;\n}\n\n.fa-sync-alt {\n  position: absolute;\n  top: 60px;\n  left: 14px;\n  color: rgb(68, 68, 68);\n  cursor: pointer;\n}\n\n.fa-sync-alt:hover {\n  color: rgb(136, 136, 136);\n}\n",""])},function(t,e,i){var n=i(27);"string"==typeof n&&(n=[[t.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(3)(n,r);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(2)(!1)).push([t.i,"/* FRAMES */\n.frames__wrapper {\n  margin-right: 6px;\n  display: flex;\n  flex-direction: column;\n  width: 140px;\n  color: #fff;\n  align-items: center;\n  height: 608px;\n  /* height: 90vh; */\n  overflow-y: scroll;\n}\n\n.frame__background {\n  margin: 0 auto 10px;\n  width: 100px;\n  height: 100px;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAV0lEQVRYCe2WMQ4AIAgD0bDwN/7/FUb9AR2Muhxr04QclDAyc1lTEdGoZlXV6so/W/cDkQYgAAFXOT3NufIzAghA4DsBVzm9fSe+E6ABCECAf4AdgAAENkFXF0Suev9HAAAAAElFTkSuQmCC) repeat;\n}\n\n.frame__unit {\n  position: relative;\n  margin: 0 auto;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n  width: 100px;\n  height: 100px;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-size: cover;\n  border: 2px solid;\n  border-color: rgb(68, 68, 68);\n  border-radius: 5px;\n}\n\n.frame__item-button {\n  display: none;\n  width: 21px;\n  height: 21px;\n  text-align: center;\n  line-height: 21px;\n  background-color: rgba(128, 128, 128, 0.5);\n  cursor: default;\n}\n\n.index {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: block;\n}\n\n.move-frame {\n  position: absolute;\n  top: 0;\n  right: 0;\n  cursor: move;\n}\n\n.frame__unit .index {\n  color: #000;\n  background-color: rgba(255, 215, 0);\n}\n\n.copy, .trash {\n  cursor: pointer;\n}\n\n.frames__add-frame-button {\n  display: flex;\n  align-items: center;\n  margin: 0 auto;\n  padding: 0 5px;\n  width: 100px;\n  height: 43px;\n  border: 2px solid;\n  border-color: #707070;\n  border-radius: 5px;\n  font-size: 14px;\n  vertical-align: middle;\n  color: #707070;\n}\n\n.frames__add-frame-button:hover {\n  border-color: rgba(255, 215, 0);\n  cursor: pointer;\n}\n\n.frames__add-frame-button i {\n  color: #fff;\n  font-size: 21px;\n  padding-right: 10px;\n}\n\n/* SCROLLBAR */\n.frames__wrapper::-webkit-scrollbar-track {\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  border-radius: 3px;\n  background-color: rgb(37, 37, 37);\n}\n\n.frames__wrapper::-webkit-scrollbar {\n  width: 7px;\n  background-color: transparent;\n}\n\n.frames__wrapper::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  background-color: rgb(102, 102, 102);\n}\n",""])},function(t,e,i){"use strict";i.r(e);class n{constructor(){this.switchColorButton=document.querySelector("#switch-colors"),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color")}switchColors(){const t=this.primaryColor.value;this.primaryColor.value=this.secondaryColor.value,this.secondaryColor.value=t}init(){this.switchColorButton.addEventListener("click",this.switchColors.bind(this))}}class r{constructor(t){this.emptyFrame=t,this.frameWrapper=document.querySelector(".frames__wrapper"),this.addFrameButton=document.querySelector(".frames__add-frame-button")}init(t){const e=this.emptyFrame.cloneNode(!0);e.children[0].children[1].textContent=t,this.frameWrapper.insertBefore(e,this.addFrameButton)}}class a{static clone(t){if(t){const e=document.createElement("canvas"),i=e.getContext("2d");return e.setAttribute("class","canvas__item"),e.width=t.width,e.height=t.height,i.drawImage(t,0,0),e}return null}}let s=0;const o=[];function c(t){s=t}class h{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.frameWrapper=document.querySelector(".frames__wrapper"),this.addFrameButton=document.querySelector(".frames__add-frame-button"),this.emptyCanvas=a.clone(this.canvas),this.emptyFrame=document.querySelector(".frame__background"),this.emptyDataURL=this.canvas.toDataURL(),this.drawNewFrame=new r(this.emptyFrame),this.cloneCanvas=new a}showFramesButtons(t){let{target:e}=t;for(;e.className.indexOf("frames__wrapper")<0;){if(e.className.indexOf("frame__unit")>=0){this.hideAllFramesButtons(),[...e.children].map(t=>t.style.display="block")}e=e.parentElement}}hideFramesButtons(t){t.target.className.indexOf("frames__wrapper")>=0&&this.hideAllFramesButtons()}hideAllFramesButtons(){[...document.querySelectorAll(".hide-button")].map(t=>t.style.display="none")}init(){this.frameWrapper.style.height=this.canvasHeight,this.frameWrapper.addEventListener("mouseover",this.showFramesButtons.bind(this)),this.frameWrapper.addEventListener("mouseover",this.hideFramesButtons.bind(this)),this.frameWrapper.addEventListener("mouseleave",this.hideAllFramesButtons.bind(this))}}let l;class d{static check(t){return t.target.parentElement.className.indexOf("frame__unit")>=0?c(t.target.parentElement.children[1].textContent):t.target.className.indexOf("frame__unit")>=0?c(t.target.children[1].textContent):c(t.target.parentElement.parentElement.children[1].textContent),s&&(l=s,l-=1),c(l),s}}let u=null;const f=[];class p{constructor(){this.fpsInput=document.querySelector("#fps"),this.previewBackground=document.querySelector(".preview__background"),this.fullScreenButton=document.querySelector("#fullScreen")}show(){f.length=0,clearInterval(u);const t=[...document.querySelectorAll(".frame__unit")];t.map(t=>{f.push(t.style.backgroundImage)});const e=document.querySelector(".preview__item");let i=100;if(0==+this.fpsInput.value)return e.style.backgroundImage=f[s],i=0;i=1e3/+this.fpsInput.value;let n=0;u=window.setInterval(()=>{e.style.backgroundImage=f[n],n>=t.length?n=0:n+=1},i)}showFPS(){document.querySelector("#show-fps").textContent=`${this.fpsInput.value} FPS`}showFullScreenButton(t){let{target:e}=t;for(;e.className.indexOf("preview__background")<0;){e.className.indexOf("preview__item")>=0&&(this.fullScreenButton.style.display="block"),e=e.parentElement}}hideFullScreenButton(t){t.target.className.indexOf("preview__background")>=0&&(this.fullScreenButton.style.display="none")}init(){this.fpsInput.addEventListener("input",this.show.bind(this)),this.fpsInput.addEventListener("input",this.showFPS.bind(this)),this.previewBackground.addEventListener("mouseover",this.showFullScreenButton.bind(this)),this.previewBackground.addEventListener("mouseleave",this.hideFullScreenButton.bind(this))}}class m{constructor(t){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.emptyDataURL=t,this.cloneCanvas=new a}setEmpty(){[...document.querySelectorAll(".frame__unit")][s].style.backgroundImage=`url('${this.emptyDataURL}')`}init(t,e){this.canvas=document.querySelector(".canvas__item");const i=[...document.querySelectorAll(".frame__unit")];if(o[s]=a.clone(this.canvas),e){i[i.length-1].style.backgroundImage=e}else{const t=this.canvas.toDataURL();i[s].style.backgroundImage=`url('${t}')`}this.previewTool=new p,this.previewTool.show()}}let g=0;const v=[32,64,128];class _{constructor(){this.resizeButton=document.querySelector(".resize__button"),this.resizeInfo=document.querySelector(".resize__info"),this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.previewTool=new p,this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.canvasBuffer=document.querySelector(".canvas__buffer")}changeSize(){this.canvas=document.querySelector(".canvas__item"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),(g+=1)>2&&(g=0);const t=this.canvas.parentElement.offsetHeight,e=Math.round(t/v[g])*v[g],i=document.createElement("canvas"),n=i.getContext("2d");i.width=`${e}`,i.height=`${e}`;const r=(e-this.canvas.width)/2;n.drawImage(this.canvas,r,r),this.canvas.width=`${e}`,this.canvas.height=`${e}`,this.canvasBuffer.width=`${e}`,this.canvasBuffer.height=`${e}`,this.canvasBackground.style.height=`${e}px`,this.resizeInfo.textContent=`${v[g]} / ${v[g]}`,this.ctx.drawImage(i,0,0),this.previewTool.show()}getCurrentPixelSize(){return this.canvas=document.querySelector(".canvas__item"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.canvas.parentElement.offsetHeight/v[g]}init(){this.resizeButton.addEventListener("click",this.changeSize.bind(this)),this.resizeButton.addEventListener("click",this.setFramePrev.init.bind(this))}}class b{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.clickX=[],this.clickY=[],this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e){this.ctx.fillStyle=this.color,this.ctx.fillRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,i,n){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(i,n);let s=r[0],o=r[1];const c=a[0],h=a[1],l=Math.abs(c-s),d=Math.abs(h-o),u=s<c?this.pixelSize:-this.pixelSize,f=o<h?this.pixelSize:-this.pixelSize;let p=l-d;for(;s!==c||o!==n;){const t=2*p;t>-d&&(p-=d,s+=u),t<l&&(p+=l,o+=f),this.drawPixel(s,o)}}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1]),this.prevDot=[...n]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,i),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",b.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/pen.png') 0 16, auto"}}class w{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.clickX=[],this.clickY=[],this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e){this.ctx.fillStyle=this.color,this.ctx.fillRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,i,n){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(i,n),s=this.getRightCoordinate(...this.reflectPoint);let o=r[0],c=r[1];const h=a[0],l=a[1],d=s[0],u=Math.abs(h-o),f=Math.abs(l-c);let p=o,m=c;const g=o<h?this.pixelSize:-this.pixelSize,v=c<l?this.pixelSize:-this.pixelSize;let _=u-f;for(;o!==h||c!==n;){const t=2*_;t>-f&&(_-=f,o+=g),t<u&&(_+=u,c+=v),p=d===o?o:d>o?d+(d-o):d-(o-d),m=c,this.drawPixel(o,c),this.drawPixel(p,m)}}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1]),this.prevDot=[...n],this.reflectPoint=[...n]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,i),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",w.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/vertical-mirror-pen.png') 0 16, auto"}}const y=[];class x{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.startR=0,this.startG=0,this.startB=0,this.startA=1,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.targetColor=void 0,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}getStartPoint(t){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop,n=this.ctx.getImageData(e,i,1,1);return this.startR=n.data[0],this.startG=n.data[1],this.startB=n.data[2],this.startA=n.data[3]/255,[e,i]}matchStartColor(t){const e=this.colorLayer.data[t],i=this.colorLayer.data[t+1],n=this.colorLayer.data[t+2];return e===this.startR&&i===this.startG&&n===this.startB}colorPixel(t){const e=this.hexToRgb(this.targetColor),i=e.r,n=e.g,r=e.b;this.colorLayer.data[t]=i,this.colorLayer.data[t+1]=n,this.colorLayer.data[t+2]=r,this.colorLayer.data[t+3]=255}paint(t){0===t.button?this.targetColor=this.primaryColor.value:2===t.button&&(this.targetColor=this.secondaryColor.value),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),y.push(this.getStartPoint(t));const e=this.hexToRgb(this.targetColor);if(e.r===this.startR&&e.g===this.startG&&e.b===this.startB)return!1;for(;y.length;){let t,e,i;const n=y.pop(),r=n[0];let a=n[1];for(t=4*(a*this.canvasWidth+r);a-- >=0&&this.matchStartColor(t);)t-=4*this.canvasWidth;for(t+=4*this.canvasWidth,++a,e=!1,i=!1;a++<this.canvasHeight-1&&this.matchStartColor(t);)this.colorPixel(t),r>0&&(this.matchStartColor(t-4)?e||(y.push([r-1,a]),e=!0):e&&(e=!1)),r<this.canvasWidth-1&&(this.matchStartColor(t+4)?i||(y.push([r+1,a]),i=!0):i&&(i=!1)),t+=4*this.canvasWidth}this.ctx.putImageData(this.colorLayer,0,0)}init(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground.addEventListener("mousedown",this.paint.bind(this)),this.canvasBackground.addEventListener("contextmenu",x.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/paint-bucket.png') 16 16, auto"}}class k{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.targetColor=null,this.startR=0,this.startG=0,this.startB=0,this.startA=1,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}static hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}getStartPoint(t){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop,n=this.ctx.getImageData(e,i,1,1);this.startR=n.data[0],this.startG=n.data[1],this.startB=n.data[2],this.startA=n.data[3]/255}colorPixels(t){for(let e=0;e<t.length;e+=4){const i=this.startR===t[e],n=this.startG===t[e+1],r=this.startB===t[e+2];i&&n&&r&&(t[e]=this.targetColor.r,t[e+1]=this.targetColor.g,t[e+2]=this.targetColor.b,t[e+3]=255)}}paint(t){if(0===t.button?this.targetColor=this.primaryColor.value:2===t.button&&(this.targetColor=this.secondaryColor.value),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.colorLayer=this.ctx.getImageData(0,0,this.canvasWidth,this.canvasHeight),this.getStartPoint(t),this.targetColor=k.hexToRgb(this.targetColor),this.targetColor.r===this.startR&&this.targetColor.g===this.startG&&this.targetColor.b===this.startB)return!1;this.colorPixels.bind(this),this.colorPixels(this.colorLayer.data),this.ctx.putImageData(this.colorLayer,0,0)}init(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.paint.bind(this)),this.canvasBackground.addEventListener("contextmenu",k.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/paint-bucket.png') 16 16, auto"}}class S{constructor(t,e){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.pixelSize=this.canvas.width/this.numRows,this.clickX=[],this.clickY=[],this.paint=!1,this.prevDot=[],this.currDot=[],this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e){this.ctx.clearRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,i,n){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(i,n);let s=r[0],o=r[1];const c=a[0],h=a[1],l=Math.abs(c-s),d=Math.abs(h-o),u=s<c?this.pixelSize:-this.pixelSize,f=o<h?this.pixelSize:-this.pixelSize;let p=l-d;for(;s!==c||o!==n;){const t=2*p;t>-d&&(p-=d,s+=u),t<l&&(p+=l,o+=f),this.drawPixel(s,o)}}startDrawing(t){t.preventDefault(),this.pixelSize=this.resizeTool.getCurrentPixelSize();const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1]),this.prevDot=[...n]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,i),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",S.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/eraser.png') 0 16, auto"}}class C{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e,i){i.fillStyle=this.color,i.fillRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,i,n,r){const a=this.getRightCoordinate(t,e),s=this.getRightCoordinate(i,n);let o=a[0],c=a[1];const h=s[0],l=s[1],d=Math.abs(h-o),u=Math.abs(l-c),f=o<h?this.pixelSize:-this.pixelSize,p=c<l?this.pixelSize:-this.pixelSize;let m=d-u;for(;o!==h||c!==n;){const t=2*m;t>-u&&(m-=u,o+=f),t<d&&(m+=d,c+=p),this.drawPixel(o,c,r)}}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1],this.ctxBuffer),this.prevDot=[...n]}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),e||(e=this.ctxBuffer),this.drawPixel(...this.prevDot,e);const i=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=this.getRightCoordinate(i,n),this.bresenhamAlgorithm(...this.prevDot,...this.currDot,e)}}stopDrawing(t){this.draw(t,this.ctx),this.paint=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",C.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/stroke.png') 0 16, auto"}}class z{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e,i){i.fillStyle=this.color,i.fillRect(t,e,this.pixelSize,this.pixelSize)}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1],this.ctxBuffer),this.prevDot=[...n]}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),e||(e=this.ctxBuffer),this.drawPixel(...this.prevDot,e);const i=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=this.getRightCoordinate(i,n),this.bresenhamAlgorithm(...this.prevDot,...this.currDot,e)}}bresenhamAlgorithm(t,e,i,n,r){const a=this.getRightCoordinate(t,e),s=this.getRightCoordinate(i,n);let o=a[0],c=a[1],h=a[0],l=a[1];const d=s[0],u=s[1],f=o<d?this.pixelSize:-this.pixelSize,p=c<u?this.pixelSize:-this.pixelSize;for(;;){if(o!==d)o+=f;else{if(c===u)break;c+=p}this.drawPixel(o,c,r)}for(;;){if(l!==u)l+=p;else{if(h===d)break;h+=f}this.drawPixel(h,l,r)}}stopDrawing(t){this.draw(t,this.ctx),this.paint=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",z.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/rectangle.png') 0 16, auto"}}class B{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e,i){i.fillStyle=this.color,i.fillRect(t,e,this.pixelSize,this.pixelSize)}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?this.color=this.primaryColor.value:2===t.button&&(this.color=this.secondaryColor.value);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1],this.ctxBuffer),this.prevDot=[...n]}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),e||(e=this.ctxBuffer);const i=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=this.getRightCoordinate(i,n),this.ellipseAlgorithm(...this.prevDot,...this.currDot,e)}}ellipseAlgorithm(t,e,i,n,r){const a=Math.abs(t-i)/2,s=Math.abs(e-n)/2,o=[],c=[];let h=0-a,l=0;const d=t<i?this.pixelSize:-this.pixelSize;for(;h!==a+d;)l=Math.sqrt((1-h**2/a**2)*s**2),o.push([h+a+t,e+s-l]),h+=d;for(h=0-a,l=0;h!==a+d;)l=Math.sqrt((1-h**2/a**2)*s**2),c.push([h+a+t,e+s+l]),h+=d;c.reverse();const u=[...o,...c];for(let t=0;t<u.length;t+=1)u[t]=this.getRightCoordinate(...u[t]);for(let t=0;t<u.length-1;t+=1)u[t]=this.getRightCoordinate(...u[t]),this.bresenhamAlgorithm(...u[t],...u[t+1],r)}bresenhamAlgorithm(t,e,i,n,r){const a=this.getRightCoordinate(t,e),s=this.getRightCoordinate(i,n);let o=a[0],c=a[1];const h=s[0],l=s[1];if(isNaN(o)||isNaN(c)||isNaN(h)||isNaN(l))return;const d=Math.abs(h-o),u=Math.abs(l-c),f=o<h?this.pixelSize:-this.pixelSize,p=c<l?this.pixelSize:-this.pixelSize;let m=d-u,g=0;for(;g<100&&(o!==h||c!==n);){const t=2*m;t>-u&&(m-=u,o+=f),t<d&&(m+=d,c+=p),this.drawPixel(o,c,r),g+=1}}stopDrawing(t){this.draw(t,this.ctx),this.paint=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",B.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/circle.png') 0 16, auto"}}class A{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=null,this.canvasBackground=document.querySelector(".canvas__background"),this.cloneCanvas=new a,this.drag=!1}static canselDefaultRightClich(t){t.preventDefault()}moveStart(t){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.image=new Image,this.image.src=this.canvas.toDataURL();const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.prevDot=[e,i],this.drag=!0}move(t){if(this.drag){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=[e,i];const n=[this.currDot[0]-this.prevDot[0],this.currDot[1]-this.prevDot[1]];this.ctx.drawImage(this.image,...n)}}moveStop(){this.drag=!1}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.moveStart.bind(this)),this.canvasBackground.addEventListener("mousemove",this.move.bind(this)),this.canvasBackground.addEventListener("mouseup",this.moveStop.bind(this)),this.canvasBackground.addEventListener("contextmenu",A.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/hand.png') 8 8, auto"}}class E{constructor(t,e){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color="rgba(130, 163, 178, 0.5)",this.pixelSize=this.canvas.width/this.numRows,this.paint=!1,this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.rectWidthCut=void 0,this.rectHeightCut=void 0,this.prevDot=[],this.currDot=[],this.drag=!1,this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.memoryCanvas=null,this.ctxMemory=null,this.cloneCanvas=new a,this.canvasWrapper=document.querySelector("#canvas__wrapper")}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e,i){i.fillStyle=this.color,i.fillRect(t,e,this.pixelSize,this.pixelSize)}startDrawing(t){if(!this.selectArea&&!this.inArea(t)&&!this.paint){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.ctxBuffer.globalAlpha=.8,this.pixelSize=this.resizeTool.getCurrentPixelSize();const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.paint=!0,this.firstPoint=this.getRightCoordinate(e,i),this.secondPoint=[...this.firstPoint]}}draw(t,e){if(this.paint){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.selectArea=!0,e||(e=this.ctxBuffer);const i=t.pageX-this.canvasBuffer.parentElement.offsetLeft,n=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.secondPoint=this.getRightCoordinate(i,n),this.secondPoint[0]>this.firstPoint[0]?this.rectWidthCut=this.secondPoint[0]-this.firstPoint[0]+this.pixelSize:this.secondPoint[0]===this.firstPoint[0]?this.rectWidthCut=this.pixelSize:this.rectWidthCut=this.secondPoint[0]-this.firstPoint[0]-this.pixelSize,this.secondPoint[1]>this.firstPoint[1]?this.rectHeightCut=this.secondPoint[1]-this.firstPoint[1]+this.pixelSize:this.secondPoint[0]===this.firstPoint[0]?this.rectHeightCut=this.pixelSize:this.rectHeightCut=this.secondPoint[1]-this.firstPoint[1]-this.pixelSize,this.ctxBuffer.fillStyle="rgba(130, 163, 178)",this.ctxBuffer.fillRect(this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut)}}cut(){this.image2=new Image,this.image2.src=this.canvas.toDataURL(),this.ctxBuffer.drawImage(this.canvas,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut),this.selectArea&&this.ctx.clearRect(this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut)}stopDrawing(){this.paint&&(this.cut(),this.paint=!1)}moveStart(t){if(this.selectArea&&this.inArea(t)&&!this.paint){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.image=new Image,this.image.src=this.canvasBuffer.toDataURL();const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.prevDot=[e,i],this.drag=!0,this.canvasWrapper.style.cursor="move"}}move(t){if(this.drag){this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height);const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;this.currDot=[e,i];const n=[this.currDot[0]-this.prevDot[0],this.currDot[1]-this.prevDot[1]];this.ctxBuffer.drawImage(this.image,...n)}}moveStop(t){if(this.drag){this.drag=!1;const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop,n=this.firstPoint[0]-this.prevDot[0],r=this.firstPoint[1]-this.prevDot[1];this.currDot=[e+n,i+r],this.ctx.drawImage(this.image2,this.firstPoint[0],this.firstPoint[1],this.rectWidthCut,this.rectHeightCut,...this.currDot,this.rectWidthCut,this.rectHeightCut),this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.canvasWrapper.style.cursor="crosshair"}}unSelect(t){!this.selectArea||this.inArea(t)||this.paint||(this.ctx.drawImage(this.image2,...this.firstPoint,this.rectWidthCut,this.rectHeightCut,...this.firstPoint,this.rectWidthCut,this.rectHeightCut),this.ctxBuffer.clearRect(0,0,this.canvasBuffer.width,this.canvasBuffer.height),this.image2=new Image,this.selectArea=!1,this.firstPoint=[0,0],this.secondPoint=[0,0],this.paint=!1)}inArea(t){const e=t.pageX-this.canvasBuffer.parentElement.offsetLeft,i=t.pageY-this.canvasBuffer.parentElement.offsetTop;return this.firstPoint[0]<this.secondPoint[0]&&this.firstPoint[1]<this.secondPoint[1]&&e<this.secondPoint[0]+this.pixelSize&&e>this.firstPoint[0]&&i<this.secondPoint[1]+this.pixelSize&&i>this.firstPoint[1]||(this.firstPoint[0]>this.secondPoint[0]&&this.firstPoint[1]>this.secondPoint[1]&&e<this.firstPoint[0]&&e>this.secondPoint[0]-this.pixelSize&&i<this.firstPoint[1]&&i>this.secondPoint[1]-this.pixelSize||(this.firstPoint[0]>this.secondPoint[0]&&this.firstPoint[1]<this.secondPoint[1]&&e<this.firstPoint[0]&&e>this.secondPoint[0]-this.pixelSize&&i<this.secondPoint[1]+this.pixelSize&&i>this.firstPoint[1]||this.firstPoint[0]<this.secondPoint[0]&&this.firstPoint[1]>this.secondPoint[1]&&e<this.secondPoint[0]+this.pixelSize&&e>this.firstPoint[0]&&i<this.firstPoint[1]&&i>this.secondPoint[1]-this.pixelSize))}cursorEffect(t){this.selectArea&&this.inArea(t)?this.canvasWrapper.style.cursor="move":this.drag?this.canvasWrapper.style.cursor="move":this.canvasWrapper.style.cursor="crosshair"}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.unSelect.bind(this)),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mousedown",this.moveStart.bind(this)),this.canvasBackground.addEventListener("mousemove",this.move.bind(this)),this.canvasBackground.addEventListener("mouseup",this.moveStop.bind(this)),this.canvasBackground.addEventListener("contextmenu",E.canselDefaultRightClich.bind(this)),this.canvasBackground.addEventListener("mousemove",this.cursorEffect.bind(this)),this.canvasWrapper.style.cursor="url('https://www.piskelapp.com/p/img/cursors/stroke.png') 0 16, auto"}}class R{constructor(){this.canvasBackground=document.querySelector(".canvas__background"),this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.light=!1,this.resizeTool=new _}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}startWork(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),this.light=!0}lightPixels(t){if(this.light){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop,n=this.getRightCoordinate(e,i),r=this.ctx.getImageData(...n,this.pixelSize,this.pixelSize),{data:a}=r;for(let t=0;t<a.length;t+=4)a[t]>=255?a[t]=255:a[t]+=10,a[t+1]>=255?a[t+1]=255:a[t+1]+=10,a[t+2]>=255?a[t+2]=255:a[t+2]+=10;this.ctx.putImageData(r,...n,0,0,this.pixelSize,this.pixelSize)}}endWork(){this.light=!1}init(){this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startWork.bind(this)),this.canvasBackground.addEventListener("mousemove",this.lightPixels.bind(this)),this.canvasBackground.addEventListener("mouseup",this.endWork.bind(this)),this.canvasBackground.addEventListener("contextmenu",R.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/lighten.png') 0 16, auto"}}class D{constructor(t,e,i){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.numRows=t,this.numCols=e,this.color=i||"#000",this.pixelSize=this.canvas.width/this.numRows,this.clickX=[],this.clickY=[],this.paint=!1,this.prevDot=[],this.currDot=[],this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color"),this.resizeTool=new _,this.canvasBackground=document.querySelector(".canvas__background"),this.buttonUsed=void 0,this.color1=this.primaryColor.value,this.color2=this.secondaryColor.value}static canselDefaultRightClich(t){t.preventDefault()}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}drawPixel(t,e){const i=t/this.pixelSize,n=e/this.pixelSize;this.color=n%2==0?i%2==0?this.color2:this.color1:i%2==0?this.color1:this.color2,this.ctx.fillStyle=this.color,this.ctx.fillRect(t,e,this.pixelSize,this.pixelSize)}bresenhamAlgorithm(t,e,i,n){const r=this.getRightCoordinate(t,e),a=this.getRightCoordinate(i,n);let s=r[0],o=r[1];const c=a[0],h=a[1],l=Math.abs(c-s),d=Math.abs(h-o),u=s<c?this.pixelSize:-this.pixelSize,f=o<h?this.pixelSize:-this.pixelSize;let p=l-d;for(;s!==c||o!==n;){const t=2*p;t>-d&&(p-=d,s+=u),t<l&&(p+=l,o+=f),this.drawPixel(s,o)}}startDrawing(t){t.preventDefault(),this.canvas=document.querySelector(".canvas__item"),this.pixelSize=this.resizeTool.getCurrentPixelSize(),0===t.button?(this.color1=this.primaryColor.value,this.color2=this.secondaryColor.value):2===t.button&&(this.color2=this.primaryColor.value,this.color1=this.secondaryColor.value);const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.paint=!0;const n=this.getRightCoordinate(e,i);this.drawPixel(n[0],n[1]),this.prevDot=[...n]}stopDrawing(){this.paint=!1}draw(t){if(this.paint){const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.currDot=this.getRightCoordinate(e,i),this.bresenhamAlgorithm(...this.prevDot,...this.currDot),this.prevDot=this.currDot}}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.startDrawing.bind(this)),this.canvasBackground.addEventListener("mousemove",this.draw.bind(this)),this.canvasBackground.addEventListener("mouseup",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.stopDrawing.bind(this)),this.canvasBackground.addEventListener("contextmenu",D.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/dither.png') 0 16, auto"}}class q{constructor(){this.canvasBackground=document.querySelector(".canvas__background"),this.primaryColor=document.querySelector("#primary-color"),this.secondaryColor=document.querySelector("#secondary-color")}static canselDefaultRightClich(t){t.preventDefault()}static rgbToHex(t,e,i){return`#${((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)}`}pickColor(t){const e=document.querySelector(".canvas__item").getContext("2d"),i=t.layerX,n=t.layerY,r=e.getImageData(i,n,1,1),{data:a}=r,s=q.rgbToHex(a[0],a[1],a[2]);0===t.button?this.primaryColor.value=s:2===t.button&&(this.secondaryColor.value=s)}init(){this.canvasBackground=document.querySelector(".canvas__background"),this.canvasBackground.addEventListener("mousedown",this.pickColor.bind(this)),this.canvasBackground.addEventListener("contextmenu",q.canselDefaultRightClich.bind(this)),document.querySelector("#canvas__wrapper").style.cursor="url('https://www.piskelapp.com/p/img/cursors/dropper.png') 0 16, auto"}}class T{constructor(){this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.cloneCanvas=new a}init(){this.canvasBackground=document.querySelector(".canvas__background");const t=this.canvasBackground.cloneNode(!0);t.classList.add("canvas__background"),this.canvasBackground.parentNode.replaceChild(t,this.canvasBackground),this.canvas=document.querySelector(".canvas__item");const e=this.canvas.parentNode,i=a.clone(o[s]);i&&e.replaceChild(i,this.canvas),e.children[0].className="canvas__item"}}let L,I="pen";class F{constructor(){this.canvas=document.querySelector(".canvas__item"),this.toolsWrapper=document.querySelector(".tools__wrapper"),this.allToolsItems=document.querySelectorAll(".tools__item"),this.currentTool="pen",this.penTool=new b(this.numRows,this.numCols),this.mirrorTool=new w(this.numRows,this.numCols),this.bucketTool=new x,this.fillBucketTool=new k,this.eraserTool=new S(this.numRows,this.numCols),this.strokeTool=new C(this.numRows,this.numCols),this.rectangle=new z(this.numRows,this.numCols),this.circle=new B(this.numRows,this.numCols),this.move=new A,this.crop=new E,this.lighten=new R,this.dithering=new D(this.numRows,this.numCols),this.colorPickerCanvas=new q,this.cloneCanvasBackground=new T}static canselDefaultRightClich(t){t.preventDefault()}static cloneCanvas(t){const e=document.createElement("canvas");e.classList.add("canvas__item");const i=e.getContext("2d");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0),e}deletePrevFeature(){this.canvas=document.querySelector(".canvas__item");const t=this.canvas,e=F.cloneCanvas(t);t.parentNode.replaceChild(e,t),this.canvas=e,this.cloneCanvasBackground.init(),this.canvas.addEventListener("contextmenu",F.canselDefaultRightClich.bind(this))}highlight(t){[...this.allToolsItems].map(t=>{t.classList.remove("highlight_tool")}),t.classList.add("highlight_tool")}setTool(t){switch(this.deletePrevFeature(),I){case"pen":this.penTool.init();break;case"mirror":this.mirrorTool.init();break;case"eraser":this.eraserTool.init();break;case"paint-bucket":this.bucketTool.init();break;case"fill-bucket":this.fillBucketTool.init();break;case"stroke":this.strokeTool.init();break;case"rectangle":this.rectangle.init();break;case"circle":this.circle.init();break;case"move":this.move.init();break;case"crop":this.crop.init();break;case"lighten":this.lighten.init();break;case"dithering":this.dithering.init();break;case"color-picker":this.colorPickerCanvas.init();break;default:this.penTool.init()}this.highlight(t)}defineTool(t){let{target:e}=t,i=null;for(;"UL"!==e.tagName;)I=e.getAttribute("data-tool"),i=e,e=e.parentElement;this.setTool(i)}static setCurrentTool(t){I=t}activePreviousTool(){const t=document.querySelector(".highlight_tool");I=t.getAttribute("data-tool"),this.setTool(t)}init(){const t=document.querySelector(".highlight_tool");this.setTool(t),this.toolsWrapper.addEventListener("click",this.defineTool.bind(this))}}const P=[!1];class U{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.baseFrame=document.querySelector(".frame__unit"),this.frameWrapper=document.querySelector(".frames__wrapper"),this.addFrameButton=document.querySelector(".frames__add-frame-button"),this.emptyFrame=document.querySelector(".frame__background"),this.drawNewFrame=new r(this.emptyFrame),this.cloneCanvas=new a,this.emptyCanvas=a.clone(this.canvas),this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.previewTool=new p,this.checkCurrentTool=new F}delete(){P[0]=!0,this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d");const t=[...document.querySelectorAll(".frame__background")];this.frameWrapper=document.querySelector(".frames__wrapper"),this.frameWrapper.removeChild(t[s]),o.splice(s,1),s&&(L=s,c(L-=1));const e=this.canvas.parentNode;if(0!==o.length){const t=a.clone(o[s]);e.replaceChild(t,this.canvas),e.children[0].className="canvas__item",this.setFramePrev.init()}else{this.drawNewFrame.init(s+1),e.replaceChild(this.emptyCanvas,this.canvas),e.children[0].className="canvas__item",this.setFramePrev.setEmpty()}}deleteFrame(t){if(this.canvas=document.querySelector(".canvas__item"),t.target.className.indexOf("trash")>=0){o[s]=a.clone(this.canvas),c(d.check(t)),this.delete(),[...document.querySelectorAll(".frame__unit")].map((t,e)=>{t.children[1].textContent=`${e+1}`}),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.deleteFrame.bind(this))}}class M{constructor(){this.framesArray=[...document.querySelectorAll(".frame__unit")],this.frameWrapper=document.querySelector(".frames__wrapper")}highlightSelectedFrame(){this.framesArray=[...document.querySelectorAll(".frame__unit")],this.framesArray.forEach(t=>{t.style.borderColor="rgb(68, 68, 68)"}),this.framesArray[s].style.borderColor="rgb(255, 215, 0)"}init(){this.frameWrapper.addEventListener("mousedown",this.highlightSelectedFrame.bind(this))}}class W{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.frameWrapper=document.querySelector(".frames__wrapper"),this.addFrameButton=document.querySelector(".frames__add-frame-button"),this.emptyCanvas=a.clone(this.canvas),this.emptyDataURL=this.canvas.toDataURL(),this.emptyFrame=document.querySelector(".frame__background"),this.setFramePrev=new m(this.emptyDataURL),this.cloneCanvas=new a,this.drawNewFrame=new r(this.emptyFrame),this.previewTool=new p,this.checkCurrentTool=new F,this.showCurrentFrame=new M}addFrame(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),o[s]=a.clone(this.canvas),this.ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight),c(o.length),o.push(this.emptyCanvas),this.drawNewFrame.init(s+1),this.showCurrentFrame.highlightSelectedFrame(),this.setFramePrev.setEmpty(s),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}class O{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.cloneCanvas=new a,this.prevFrame=0,this.currentFrame=0,this.emptyFrame=document.querySelector(".frame__background"),this.drawNewFrame=new r(this.emptyFrame),this.setFramePrev=new m,this.frameWrapper=document.querySelector(".frames__wrapper"),this.previewTool=new p,this.checkCurrentTool=new F}run(t){if(this.canvas=document.querySelector(".canvas__item"),t.target.className.indexOf("copy")>-1){o[s]=a.clone(this.canvas),c(d.check(t)),o.push(o[s]);const e=[...document.querySelectorAll(".frame__unit")][s].style.backgroundImage,i=this.canvas.parentElement;this.canvas=document.querySelector(".canvas__item");const n=a.clone(o[s]);i.replaceChild(n,this.canvas),i.children[0].setAttribute("class","canvas__item"),this.prevFrame=this.currentFrame,this.currentFrame+=1;const r=o.length;this.drawNewFrame.init(r),this.setFramePrev.init(null,e),c(o.length-1),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.run.bind(this))}}class N{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.header=document.querySelector(".header"),this.main=document.querySelector(".main"),this.framesWrapper=document.querySelector(".frames__wrapper"),this.resizeButton=document.querySelector(".resize__button"),this.resizeTimer=void 0,this.canvasBuffer=document.querySelector(".canvas__buffer")}resizeWithTimer(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.changeSize()},300)}changeSize(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBuffer=document.querySelector(".canvas__buffer"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background");const t=window.innerHeight,e=this.header.offsetHeight;let i=this.main.currentStyle||window.getComputedStyle(this.main),n=t-e-5*(i=i.marginTop.slice(0,-2));n=Math.round(n/v[g])*v[g];const r=document.createElement("canvas"),a=r.getContext("2d");r.width=`${n}`,r.height=`${n}`;const s=(n-this.canvas.width)/2;a.drawImage(this.canvas,s,s);const o=document.createElement("canvas"),c=o.getContext("2d");o.width=`${n}`,o.height=`${n}`;const h=(n-this.canvasBuffer.width)/2;c.drawImage(this.canvasBuffer,h,h),this.canvas.width=`${n}`,this.canvas.height=`${n}`,this.canvasBuffer.width=`${n}`,this.canvasBuffer.height=`${n}`,this.canvasBackground.style.height=`${n}px`,this.framesWrapper.style.height=`${n}px`,this.ctx.drawImage(r,0,0),this.ctxBuffer.drawImage(o,0,0)}init(){window.addEventListener("resize",this.resizeWithTimer.bind(this)),this.resizeButton.addEventListener("click",this.changeSize.bind(this))}}class H{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.cloneCanvas=new a,this.prevFrame=0,this.currentFrame=0,this.emptyFrame=document.querySelector(".frame__unit"),this.drawNewFrame=new r(this.emptyFrame),this.setFramePrev=new m,this.frameWrapper=document.querySelector(".frames__wrapper"),this.previewTool=new p,this.resizeOfCanvas=new N,this.checkCurrentTool=new F}selectFrame(t){const e=t.target.className,i=t.target.parentElement.className;if(e.indexOf("frame__unit")>=0||i.indexOf("frame__unit")>=0){this.canvas=document.querySelector(".canvas__item"),o[s]=a.clone(this.canvas),c(d.check(t));const e=this.canvas.parentNode,i=a.clone(o[s]);e.replaceChild(i,this.canvas),e.children[0].setAttribute("class","canvas__item"),this.resizeOfCanvas.changeSize(),this.checkCurrentTool.activePreviousTool(),this.previewTool.show()}}init(){this.frameWrapper.addEventListener("mousedown",this.selectFrame.bind(this))}}class j{constructor(){this.canvasSize=document.querySelector("#canvas_size"),this.coordinates=document.querySelector("#coordinates"),this.canvasWrapper=document.querySelector("#canvas__wrapper"),this.canvas=document.querySelector(".canvas__item"),this.canvasBackground=document.querySelector(".canvas__background"),this.ctx=this.canvas.getContext("2d"),this.resizeButton=document.querySelector(".resize__button"),this.pixelSize=19,this.resizeTool=new _,this.data=32}getRightCoordinate(t,e){let i=t,n=e;return[i=Math.floor(i/this.pixelSize)*this.pixelSize,n=Math.floor(n/this.pixelSize)*this.pixelSize]}hideCoordinates(){this.coordinates.textContent=""}showCoordinates(t){this.canvasBackground=document.querySelector(".canvas__background"),this.canvas=document.querySelector(".canvas__item");const e=t.pageX-this.canvas.parentElement.offsetLeft,i=t.pageY-this.canvas.parentElement.offsetTop;this.pixelSize=this.resizeTool.getCurrentPixelSize();const n=this.getRightCoordinate(e,i),r=n[0]/this.pixelSize,a=n[1]/this.pixelSize;r<0||r>this.data-1||a<0||a>this.data-1?this.coordinates.textContent="":this.coordinates.textContent=`${r} : ${a}`}showSize(){this.data=v[g],this.canvasSize.textContent=`[ ${this.data} x ${this.data} ]`}init(){this.resizeButton.addEventListener("click",this.showSize.bind(this)),this.canvasWrapper.addEventListener("mousemove",this.showCoordinates.bind(this)),this.canvasBackground.addEventListener("mouseleave",this.hideCoordinates.bind(this))}}class G{constructor(){this.previewItem=document.querySelector(".preview__item"),this.fullScreenButton=document.querySelector("#fullScreen")}toggleFullscreen(){this.fullScreenButton.style.display="none",document.fullscreenElement?document.exitFullscreen():this.previewItem.requestFullscreen().catch(t=>{alert(`Error attempting to enable full-screen mode: ${t.message} (${t.name})`)})}init(){this.fullScreenButton.addEventListener("click",this.toggleFullscreen.bind(this))}}class Z{constructor(){this.checkCurrentTool=new F,this.allToolsItems=document.querySelectorAll(".tools__item")}static selectTool(t){switch(t.keyCode){case 80:this.getTool("pen");break;case 86:this.getTool("mirror");break;case 66:this.getTool("paint-bucket");break;case 65:this.getTool("fill-bucket");break;case 69:this.getTool("eraser");break;case 76:this.getTool("stroke");break;case 82:this.getTool("rectangle");break;case 67:this.getTool("circle");break;case 77:this.getTool("move");break;case 83:this.getTool("crop");break;case 85:this.getTool("lighten");break;case 84:this.getTool("dithering");break;case 79:this.getTool("color-picker")}}getTool(t){F.setCurrentTool(t),this.allToolsItems.forEach(e=>{if(e.getAttribute("data-tool")===t)return this.checkCurrentTool.setTool(e)})}init(){window.addEventListener("keydown",Z.selectTool.bind(this))}}class V{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=null,this.canvasBackground=document.querySelector(".canvas__background"),this.flipButton=document.querySelector(".flip__button")}flip(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=new Image,this.image.src=this.canvas.toDataURL(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.scale(-1,1),this.ctx.drawImage(this.image,-this.canvas.width,0,this.canvas.width,this.canvas.height),this.ctx.restore()}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.flipButton.addEventListener("click",this.flip.bind(this))}}class Y{constructor(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=null,this.canvasBackground=document.querySelector(".canvas__background"),this.rotationButton=document.querySelector(".rotation__button"),this.degrees=90}turnClockwise(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.image=new Image,this.image.src=this.canvas.toDataURL(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.rotate(this.degrees*Math.PI/180),this.ctx.drawImage(this.image,-this.canvas.width/2,-this.canvas.width/2),this.ctx.restore()}init(){this.canvas=document.querySelector(".canvas__item"),this.ctx=this.canvas.getContext("2d"),this.canvasBackground=document.querySelector(".canvas__background"),this.rotationButton.addEventListener("click",this.turnClockwise.bind(this))}}class X{static invert(){const t=document.querySelector(".canvas__item"),e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),{data:n}=i;for(let t=0;t<n.length;t+=4)n[t]=255-n[t],n[t+1]=255-n[t+1],n[t+2]=255-n[t+2];e.putImageData(i,0,0)}init(){document.querySelector(".invert__button").addEventListener("click",X.invert.bind(this))}}class ${constructor(){this.canvas=document.querySelector(".canvas__item"),this.frameWrapper=document.querySelector(".frames__wrapper"),this.cloneCanvas=new a,this.emptyCanvas=a.clone(this.canvas),this.previewTool=new p,this.checkCurrentTool=new F,this.showCurrentFrame=new M,this.dragAvailable=!1,this.dragedItem=null,this.oldParentOfDragedItem=null,this.elementToSwap=null,this.index=void 0,this.newIndex=void 0,this.bufferFrame=null}setCorrectIndexes(){if(this.newIndex!==this.index){this.canvas=document.querySelector(".canvas__item"),this.index-=1,this.newIndex-=1,o[this.index]=a.clone(this.canvas);const t=this.canvas.parentNode,e=a.clone(o[s]);t.replaceChild(e,this.canvas),this.bufferFrame=o[this.index],o[this.index]=o[this.newIndex],o[this.newIndex]=this.bufferFrame,c(this.newIndex);const i=document.querySelectorAll(".frame__unit");for(let t=0;t<i.length;t+=1)i[t].children[1].textContent=`${t+1}`;this.checkCurrentTool.activePreviousTool(),this.newIndex=void 0}}pickUpItem(t){let{target:e}=t;for(;e.className.indexOf("frames__wrapper")<0;){if(e.className.indexOf("frame__unit")>=0)return this.dragAvailable=!0,this.dragedItem=e,this.oldParentOfDragedItem=this.dragedItem.parentElement,void(this.startSpot=t.pageY);e=e.parentElement}}moveItem(t){if(this.dragAvailable){const e=t.pageY-this.dragedItem.offsetHeight/2;this.dragedItem.style.zIndex=100,this.dragedItem.style.position="absolute",this.dragedItem.style.top=`${e}px`}}dropItem(t){if(this.dragAvailable){if(this.dragAvailable=!1,P[0])return void(P[0]=!1);this.index=this.dragedItem.children[1].textContent;const e=t.pageY,i=this.oldParentOfDragedItem.offsetTop,n=this.oldParentOfDragedItem.offsetHeight;if(e>=i&&e<=n)return this.dragedItem.style.position="relative",this.dragedItem.style.zIndex="auto",this.dragedItem.style.top="auto",this.dragedItem.style.left="auto",void(this.newIndex=void 0);const r=document.querySelectorAll(".frame__unit");for(let i=0;i<r.length;i+=1){const n=r[i].parentElement,a=n.offsetTop,s=n.offsetHeight;if(e>=a&&e<=a+s)return t.target.style.position="relative",t.target.style.zIndex="auto",t.target.style.top="auto",t.target.style.left="auto",n.insertBefore(this.dragedItem,r[i]),this.oldParentOfDragedItem.appendChild(r[i]),this.newIndex=r[i].children[1].textContent,void this.setCorrectIndexes()}this.dragedItem.style.position="relative",this.dragedItem.style.zIndex="auto",this.dragedItem.style.top="auto",this.dragedItem.style.left="auto",this.newIndex=void 0}}init(){this.frameWrapper.addEventListener("mousedown",this.pickUpItem.bind(this)),document.body.addEventListener("mousemove",this.moveItem.bind(this)),document.body.addEventListener("mouseup",this.dropItem.bind(this))}}const K=i(10);class Q{constructor(){this.size=void 0,this.downloadButton=document.querySelector(".apng__download")}getAllSprites(){const t=[];return o.forEach(e=>{const i=e.getContext("2d").getImageData(0,0,e.width,e.height).data;this.size=e.width,t.push(i)}),t}makeAPNG(){const t=this.getAllSprites(),e=new Array(t.length);e.fill(200);const i=K.encode([...t],this.size,this.size,0,[...e]),n=new Uint8Array(i),r=btoa(String.fromCharCode.apply(null,n));this.downloadButton.href=`data:image/png;base64,${r}`}init(){this.downloadButton.addEventListener("mousedown",this.makeAPNG.bind(this))}}var J=i(9),tt=i.n(J);class et{constructor(){this.size=void 0,this.gifDownloadButton=document.querySelector(".gif__download")}getAllSprites(){const t=[];return o.forEach(e=>{const i=e.toDataURL();this.size=e.width,t.push(i)}),t}makeGIF(){const t=this.getAllSprites();if(this.gifDownloadButton.getAttribute("data-download")){const t=document.querySelector(".gif__download");t.removeAttribute("data-download"),setTimeout(()=>{t.removeAttribute("download")},200)}else tt.a.createGIF({images:[...t],gifWidth:this.size,gifHeight:this.size,interval:.2},function(t){if(!t.error){const{image:e}=t,i=document.querySelector(".gif__download");i.href=e,i.setAttribute("download","animated-image-gif"),i.setAttribute("data-download","loadFile")}}),setTimeout(()=>{document.querySelector(".gif__download").click()},1e3)}init(){this.gifDownloadButton.addEventListener("click",this.makeGIF.bind(this))}}class it{constructor(t,e){this.canvas=document.querySelector(".canvas__item"),this.toolsWrapper=document.querySelector(".tools__wrapper"),this.allToolsItems=document.querySelectorAll(".tools__item"),this.numRows=t||32,this.numCols=e||32,this.emptyDataURL=this.canvas.toDataURL(),this.setFramePrev=new m(this.emptyDataURL),this.addNewFrame=new W,this.canvasData=new j,this.addFrameButton=document.querySelector(".frames__add-frame-button"),this.canvasWrapper=document.querySelector("#canvas__wrapper"),this.shortcuts=new Z,this.flip=new V,this.rotation=new Y,this.invertColors=new X,this.flipButton=document.querySelector(".flip__button"),this.rotationButton=document.querySelector(".rotation__button"),this.invertColorsButton=document.querySelector(".invert__button"),this.dragAndDrop=new $,this.aPNG=new Q,this.gifMaker=new et}init(){this.canvasWrapper.addEventListener("contextmenu",this.canselDefaultRightClich),(new F).init(),(new n).init(),(new h).init(),(new U).init(),(new O).init(),this.dragAndDrop.init(),(new p).init(),(new _).init();const t=new N;t.init(),t.changeSize(),(new G).init(),this.flip.init(),this.rotation.init(),this.invertColors.init(),this.canvasWrapper.addEventListener("click",this.setFramePrev.init.bind(this)),this.canvasWrapper.addEventListener("contextmenu",this.setFramePrev.init.bind(this)),this.flipButton.addEventListener("click",this.setFramePrev.init.bind(this)),this.rotationButton.addEventListener("click",this.setFramePrev.init.bind(this)),this.invertColorsButton.addEventListener("click",this.setFramePrev.init.bind(this)),this.addFrameButton.addEventListener("click",this.addNewFrame.addFrame.bind(this.addNewFrame)),(new H).init(),this.firstFrame=document.querySelector(".frame__unit"),this.firstFrame.style.borderColor="rgb(255, 215, 0)",(new M).init(),this.canvasData.init(),this.shortcuts.init(),this.aPNG.init(),this.gifMaker.init()}}i(21),i(24),i(26);window.onload=void(new it).init()}]);
//# sourceMappingURL=app.bundle.js.map